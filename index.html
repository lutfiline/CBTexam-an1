<!doctype html>
<html lang="id" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TUC 1 TKA Kombel Kawula - CBT Online</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
      font-family: 'Plus Jakarta Sans', sans-serif;
    }
    
    .login-card {
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    }
    
    .question-card {
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }
    
    .nav-btn {
      transition: all 0.2s ease;
    }
    
    .nav-btn:hover {
      transform: translateY(-2px);
    }
    
    .question-num {
      transition: all 0.2s ease;
    }
    
    .question-num:hover {
      transform: scale(1.1);
    }
    
    .drag-item {
      cursor: grab;
      transition: all 0.2s ease;
    }
    
    .drag-item:active {
      cursor: grabbing;
    }
    
    .drag-item.dragging {
      opacity: 0.5;
      transform: scale(1.05);
    }
    
    .drop-zone {
      transition: all 0.2s ease;
      min-height: 44px;
    }
    
    .drop-zone.drag-over {
      background-color: #dbeafe;
      border-color: #3b82f6;
      transform: scale(1.02);
    }
    
    .matched-item {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .fade-in {
      animation: fadeIn 0.3s ease;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    
    .timer-warning {
      animation: pulse 1s infinite;
    }
    
    .progress-bar {
      transition: width 0.3s ease;
    }
    
    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: #f1f5f9;
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #94a3b8;
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: #64748b;
    }
    
    .loading-overlay {
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(4px);
    }
    
    .selected-drag-item {
      outline: 3px solid #3b82f6;
      outline-offset: 2px;
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%) !important;
    }
    
    /* Prevent text selection on mobile drag */
    .drag-item, .drop-zone {
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      -webkit-touch-callout: none;
    }
    
    /* Make touch targets larger on mobile */
    @media (max-width: 768px) {
      .drag-item {
        min-height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      
      .drop-zone {
        min-height: 48px;
      }
    }
    
    .logo-container {
      transition: all 0.3s ease;
    }
    
    .logo-container:hover {
      transform: scale(1.05);
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full bg-gradient-to-br from-blue-50 via-white to-indigo-50">
  <div id="app" class="h-full overflow-auto"><!-- Login Page -->
   <div id="loginPage" class="min-h-full flex flex-col"><!-- Header with Both Large Logos -->
    <header class="bg-gradient-to-r from-blue-700 via-blue-600 to-indigo-600 text-white py-8 px-4 md:px-6 shadow-2xl">
     <div class="max-w-7xl mx-auto flex items-center justify-between gap-4 md:gap-8"><!-- Left Logo - Purworejo -->
      <div class="logo-container flex-shrink-0">
       <div class="w-24 h-24 md:w-32 md:h-32 bg-white rounded-3xl p-2 md:p-3 shadow-2xl flex items-center justify-center border-4 border-yellow-300 overflow-hidden"><img src="https://i.ibb.co.com/9SKjynS/purworejo.png" alt="Logo Purworejo" class="w-full h-full object-cover" loading="lazy" onerror="console.error('Image failed to load:', this.src); this.style.background='#e5e7eb'; this.alt='Logo unavailable';">
       </div>
      </div><!-- Center Text -->
      <div class="flex-1 text-center px-2">
  <p class="text-yellow-200 text-2xl md:text-4xl font-black tracking-tight mb-1 md:mb-2 uppercase">WILCAMBIDIK KECAMATAN KALIGESING</p>
  <h1 id="headerTitle" class="text-2xl md:text-4xl font-black tracking-tight mb-1 md:mb-2">TUC 1 TKA Kombel Kawula</h1>
  <p class="text-blue-100 text-sm md:text-lg font-semibold">Computer Based Test - Ujian Online</p>
      </div><!-- Right Logo - Kawula -->
      <div class="logo-container flex-shrink-0">
       <div class="w-24 h-24 md:w-32 md:h-32 bg-white rounded-3xl p-2 md:p-3 shadow-2xl flex items-center justify-center border-4 border-emerald-300 overflow-hidden"><img src="https://i.ibb.co.com/wNz5ckr1/kombel-kawula-betul.jpg" alt="Logo Kawula" class="w-full h-full object-cover" loading="lazy" onerror="console.error('Image failed to load:', this.src); this.style.background='#e5e7eb'; this.alt='Logo unavailable';">
       </div>
      </div>
     </div>
    </header><!-- Login Form -->
    <main class="flex-1 flex items-center justify-center p-6">
     <div class="login-card bg-white rounded-3xl p-10 w-full max-w-md">
      <div class="text-center mb-8">
       <div class="w-20 h-20 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl mx-auto mb-4 flex items-center justify-center shadow-lg">
        <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
        </svg>
       </div>
       <h2 class="text-2xl font-bold text-gray-800">Login Peserta</h2>
       <p class="text-gray-500 mt-2">Masukkan kredensial Anda untuk memulai ujian</p>
      </div>
      <form id="loginForm" class="space-y-5">
       <div><label for="username" class="block text-sm font-semibold text-gray-700 mb-2">Username</label>
        <div class="relative"><span class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
          </svg></span> <input type="text" id="username" class="w-full pl-12 pr-4 py-3.5 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all outline-none" placeholder="Masukkan username" required>
        </div>
       </div>
       <div><label for="password" class="block text-sm font-semibold text-gray-700 mb-2">Password</label>
        <div class="relative"><span class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
          </svg></span> <input type="password" id="password" class="w-full pl-12 pr-4 py-3.5 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all outline-none" placeholder="Masukkan password" required>
        </div>
       </div>
       <div id="loginError" class="hidden bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl text-sm">
        <div class="flex items-center gap-2">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
         </svg><span>Username atau password salah!</span>
        </div>
       </div><button type="submit" id="loginBtn" class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-4 rounded-xl font-semibold text-lg hover:from-blue-700 hover:to-indigo-700 transition-all shadow-lg hover:shadow-xl nav-btn"> <span id="loginBtnText">Masuk</span> <span id="loginBtnLoading" class="hidden">
         <svg class="animate-spin h-5 w-5 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle> <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
         </svg></span> </button>
      </form>
      <div class="mt-6 text-center"><button id="adminLoginBtn" class="text-blue-600 hover:text-blue-800 text-sm font-medium hover:underline"> Login sebagai Admin → </button>
      </div>
     </div>
    </main>
   </div><!-- Admin Login Page -->
   <div id="adminLoginPage" class="min-h-full hidden flex-col">
    <header class="bg-gradient-to-r from-gray-800 via-gray-700 to-gray-800 text-white py-6 px-6 shadow-xl">
     <div class="max-w-7xl mx-auto flex items-center gap-6">
      <div class="w-20 h-20 bg-white rounded-2xl p-3 shadow-lg flex items-center justify-center border-4 border-gray-300"><span class="text-5xl leading-none">⚙️</span>
      </div>
      <div>
       <h1 class="text-3xl font-bold tracking-tight">Admin Panel</h1>
       <p class="text-gray-300 text-sm font-medium">TUC 1 TKA Kombel Kawula</p>
      </div>
     </div>
    </header>
    <main class="flex-1 flex items-center justify-center p-6">
     <div class="login-card bg-white rounded-3xl p-10 w-full max-w-md">
      <div class="text-center mb-8">
       <div class="w-20 h-20 bg-gradient-to-br from-gray-700 to-gray-900 rounded-2xl mx-auto mb-4 flex items-center justify-center shadow-lg">
        <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
        </svg>
       </div>
       <h2 class="text-2xl font-bold text-gray-800">Login Administrator</h2>
       <p class="text-gray-500 mt-2">Akses panel admin untuk mengelola ujian</p>
      </div>
      <form id="adminLoginForm" class="space-y-5">
       <div><label for="adminUsername" class="block text-sm font-semibold text-gray-700 mb-2">Username Admin</label> <input type="text" id="adminUsername" class="w-full px-4 py-3.5 border-2 border-gray-200 rounded-xl focus:border-gray-500 focus:ring-4 focus:ring-gray-100 transition-all outline-none" placeholder="admin" required>
       </div>
       <div><label for="adminPassword" class="block text-sm font-semibold text-gray-700 mb-2">Password Admin</label> <input type="password" id="adminPassword" class="w-full px-4 py-3.5 border-2 border-gray-200 rounded-xl focus:border-gray-500 focus:ring-4 focus:ring-gray-100 transition-all outline-none" placeholder="•••••••" required>
       </div>
       <div id="adminLoginError" class="hidden bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl text-sm">
        Username atau password admin salah!
       </div><button type="submit" class="w-full bg-gradient-to-r from-gray-700 to-gray-900 text-white py-4 rounded-xl font-semibold text-lg hover:from-gray-800 hover:to-black transition-all shadow-lg"> Masuk ke Admin Panel </button>
      </form>
      <div class="mt-6 text-center"><button id="backToStudentLogin" class="text-gray-600 hover:text-gray-800 text-sm font-medium hover:underline"> ← Kembali ke Login Siswa </button>
      </div>
     </div>
    </main>
   </div><!-- Exam Page -->
   <div id="examPage" class="h-full hidden flex-col"><!-- Exam Header -->
    <header class="bg-gradient-to-r from-blue-700 via-blue-600 to-indigo-600 text-white py-3 px-4 shadow-lg">
     <div class="flex items-center justify-between gap-3 flex-wrap md:flex-nowrap">
      <div class="flex items-center gap-2 md:gap-3">
       <div class="w-10 h-10 md:w-12 md:h-12 bg-white rounded-lg p-1 md:p-1.5 shadow flex items-center justify-center flex-shrink-0"><span class="text-2xl md:text-3xl leading-none">��</span>
       </div>
       <div class="hidden sm:block">
        <h1 id="examTitle" class="text-lg md:text-xl font-bold">TUC 1 TKA Kombel Kawula</h1>
        <p class="text-blue-100 text-xs md:text-sm">Ujian Online</p>
       </div>
      </div><!-- Timer -->
      <div class="flex items-center gap-2 md:gap-4">
       <div id="timerDisplay" class="bg-white/20 backdrop-blur px-2 md:px-4 py-2 rounded-xl flex items-center gap-1 md:gap-2">
        <svg class="w-4 h-4 md:w-5 md:h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg><span id="timer" class="font-bold text-sm md:text-lg font-mono">00:00</span>
       </div><!-- User Info - Hidden on Mobile -->
       <div class="hidden md:flex items-center gap-2 bg-white/10 rounded-xl px-3 py-1.5"><img id="userPhoto" src="" alt="Foto" class="w-8 h-8 rounded-full object-cover border-2 border-white" loading="lazy" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22%23fff%22><circle cx=%2212%22 cy=%228%22 r=%224%22/><path d=%22M12 14c-4 0-7 2-7 5v1h14v-1c0-3-3-5-7-5z%22/></svg>'">
        <div class="text-sm">
         <p id="userName" class="font-semibold">Nama Siswa</p>
         <p id="userClass" class="text-blue-200 text-xs">Kelas</p>
        </div>
       </div><button id="logoutBtn" class="bg-red-500 hover:bg-red-600 px-2 md:px-4 py-1.5 md:py-2 rounded-xl text-xs md:text-sm font-semibold transition-all flex items-center gap-1 md:gap-2">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
        </svg><span class="hidden sm:inline">Keluar</span> </button>
      </div>
     </div><!-- Progress Bar -->
     <div class="mt-3">
      <div class="flex justify-between text-xs text-blue-100 mb-1"><span>Progress Pengerjaan</span> <span id="progressText">0/0 soal dijawab</span>
      </div>
      <div class="h-2 bg-white/20 rounded-full overflow-hidden">
       <div id="progressBar" class="progress-bar h-full bg-gradient-to-r from-green-400 to-emerald-500 rounded-full" style="width: 0%"></div>
      </div>
     </div>
    </header><!-- Main Exam Content -->
    <div class="flex-1 flex flex-col md:flex-row overflow-hidden"><!-- Question Panel -->
     <div class="flex-1 flex flex-col overflow-hidden">
      <div class="flex-1 overflow-y-auto p-4 md:p-6">
       <div id="questionContainer" class="question-card bg-white rounded-2xl p-4 md:p-6 fade-in">
        <div class="text-center py-12">
         <div class="text-6xl mb-4">
          ����
         </div>
         <p class="text-gray-500 text-lg">Soal akan segera tersedia. Tunggu pembaruan dari admin...</p>
        </div>
       </div>
      </div><!-- Navigation Buttons -->
      <div class="bg-white border-t border-gray-200 px-3 py-3 md:px-6 md:py-4">
       <div class="flex items-center justify-between gap-2"><button id="prevBtn" class="nav-btn bg-gradient-to-r from-red-500 to-red-600 text-white px-3 py-2 md:px-6 md:py-3 rounded-xl font-semibold flex items-center gap-1 md:gap-2 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed text-sm md:text-base">
         <svg class="w-4 h-4 md:w-5 md:h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
         </svg><span class="hidden sm:inline">Sebelumnya</span> <span class="sm:hidden">Prev</span> </button> <button id="doubtBtn" class="nav-btn bg-gradient-to-r from-yellow-400 to-amber-500 text-white px-3 py-2 md:px-6 md:py-3 rounded-xl font-semibold flex items-center gap-1 md:gap-2 shadow-lg text-sm md:text-base">
         <svg class="w-4 h-4 md:w-5 md:h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
         </svg><span id="doubtBtnText" class="hidden sm:inline">Ragu-ragu</span> <span class="sm:hidden">Ragu</span> </button> <button id="toggleNavBtn" class="md:hidden nav-btn bg-gradient-to-r from-purple-500 to-purple-600 text-white px-3 py-2 rounded-xl font-semibold flex items-center gap-1 shadow-lg text-sm">
         <svg class="w-4 h-4" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
         </svg><span id="navBtnText">Nav</span> </button> <button id="nextBtn" class="nav-btn bg-gradient-to-r from-blue-500 to-blue-600 text-white px-3 py-2 md:px-6 md:py-3 rounded-xl font-semibold flex items-center gap-1 md:gap-2 shadow-lg text-sm md:text-base"> <span class="hidden sm:inline">Berikutnya</span> <span class="sm:hidden">Next</span>
         <svg class="w-4 h-4 md:w-5 md:h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
         </svg></button>
       </div>
      </div>
     </div><!-- Question Navigation Sidebar (Desktop) / Bottom Sheet (Mobile) -->
     <div id="questionNavPanel" class="hidden md:flex md:w-72 bg-gray-50 border-l border-gray-200 flex-col">
      <div class="p-4 border-b border-gray-200">
       <h3 class="font-bold text-gray-700">Navigasi Soal</h3>
      </div>
      <div class="flex-1 overflow-y-auto p-4">
       <div id="questionNav" class="grid grid-cols-5 gap-2"><!-- Question numbers will be injected here -->
       </div>
      </div>
      <div class="p-4 border-t border-gray-200"><button id="submitExamBtn" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white py-3 rounded-xl font-bold shadow-lg hover:from-green-600 hover:to-emerald-700 transition-all nav-btn"> Selesai &amp; Kumpulkan </button>
      </div>
     </div>
    </div>
   </div><!-- Result Page -->
   <div id="resultPage" class="min-h-full hidden flex-col">
    <header class="bg-gradient-to-r from-green-600 via-emerald-600 to-teal-600 text-white py-6 px-6 shadow-xl">
     <div class="max-w-7xl mx-auto flex items-center gap-4">
      <div class="w-16 h-16 bg-white rounded-2xl p-3 shadow-lg flex items-center justify-center border-4 border-yellow-300"><span class="text-5xl">����</span>
      </div>
      <div>
       <h1 class="text-2xl md:text-3xl font-bold tracking-tight">Ujian Selesai!</h1>
       <p class="text-green-100 text-sm font-medium">TUC 1 TKA Kombel Kawula</p>
      </div>
     </div>
    </header>
    <main class="flex-1 flex items-center justify-center p-6">
     <div class="login-card bg-white rounded-3xl p-10 w-full max-w-lg text-center">
      <div class="w-24 h-24 bg-gradient-to-br from-green-400 to-emerald-600 rounded-full mx-auto mb-6 flex items-center justify-center shadow-xl">
       <svg class="w-12 h-12 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
       </svg>
      </div>
      <h2 class="text-3xl font-bold text-gray-800 mb-2">Terima Kasih!</h2>
      <p class="text-gray-500 mb-8">Jawaban Anda telah berhasil disimpan</p>
      <div class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-6 mb-8">
       <p class="text-gray-600 mb-2">Skor Anda</p>
       <p id="finalScore" class="text-5xl font-bold text-blue-600 mb-2">0</p>
       <p id="scoreDetail" class="text-gray-500 text-sm">0 dari 0 soal benar</p>
      </div>
      <div class="space-y-3 text-left bg-gray-50 rounded-xl p-4 mb-6">
       <div class="flex justify-between"><span class="text-gray-600">Nama:</span> <span id="resultName" class="font-semibold text-gray-800">-</span>
       </div>
       <div class="flex justify-between"><span class="text-gray-600">Kelas:</span> <span id="resultClass" class="font-semibold text-gray-800">-</span>
       </div>
       <div class="flex justify-between"><span class="text-gray-600">Waktu Selesai:</span> <span id="resultTime" class="font-semibold text-gray-800">-</span>
       </div>
      </div><button id="backToLoginBtn" class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-4 rounded-xl font-semibold text-lg hover:from-blue-700 hover:to-indigo-700 transition-all shadow-lg nav-btn"> Kembali ke Halaman Login </button>
     </div>
    </main>
   </div><!-- Admin Panel -->
   <div id="adminPanel" class="h-full hidden flex-col"><!-- Admin Header -->
    <header class="bg-gradient-to-r from-gray-800 via-gray-700 to-gray-800 text-white py-3 px-6 shadow-lg">
     <div class="flex items-center justify-between gap-4 flex-wrap md:flex-nowrap">
      <div class="flex items-center gap-3"><span class="text-3xl md:text-4xl">⚙️</span>
       <div>
        <h1 class="text-lg md:text-xl font-bold">Admin Panel</h1>
        <p class="text-gray-400 text-xs md:text-sm">TUC 1 TKA Kombel Kawula</p>
       </div>
      </div>
      <div class="flex items-center gap-2 md:gap-3"><button id="refreshDataBtn" class="bg-blue-600 hover:bg-blue-700 px-2 md:px-4 py-1.5 md:py-2 rounded-xl text-xs md:text-sm font-semibold transition-all flex items-center gap-1 md:gap-2">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
        </svg><span class="hidden sm:inline">Refresh Data</span> <span class="sm:hidden">Refresh</span> </button> <button id="adminLogoutBtn" class="bg-red-500 hover:bg-red-600 px-2 md:px-4 py-1.5 md:py-2 rounded-xl text-xs md:text-sm font-semibold transition-all flex items-center gap-1 md:gap-2">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
        </svg><span class="hidden sm:inline">Logout</span> </button>
      </div>
     </div>
    </header>
    <div class="flex-1 flex overflow-hidden"><!-- Sidebar -->
     <nav class="w-48 md:w-64 bg-gray-900 text-white p-3 md:p-4 overflow-y-auto">
      <ul class="space-y-2">
       <li><button class="admin-nav-btn active w-full text-left px-4 py-3 rounded-xl flex items-center gap-3 transition-all hover:bg-gray-700 text-sm md:text-base" data-tab="users">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
         </svg><span class="hidden md:inline">Data Pengguna</span> <span class="md:hidden">Pengguna</span> </button></li>
       <li><button class="admin-nav-btn w-full text-left px-4 py-3 rounded-xl flex items-center gap-3 transition-all hover:bg-gray-700 text-sm md:text-base" data-tab="results">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
         </svg><span class="hidden md:inline">Hasil Ujian</span> <span class="md:hidden">Hasil</span> </button></li>
       <li><button class="admin-nav-btn w-full text-left px-4 py-3 rounded-xl flex items-center gap-3 transition-all hover:bg-gray-700 text-sm md:text-base" data-tab="settings">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
         </svg><span class="hidden md:inline">Pengaturan</span> <span class="md:hidden">Seting</span> </button></li>
      </ul>
     </nav><!-- Admin Content -->
     <div class="flex-1 overflow-y-auto p-4 md:p-6 bg-gray-100"><!-- Users Tab -->
      <div id="usersTab" class="admin-tab">
       <div class="flex items-center justify-between gap-4 mb-6 flex-wrap">
        <h2 class="text-xl md:text-2xl font-bold text-gray-800">Data Pengguna</h2><button id="addUserBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-3 md:px-4 py-2 md:py-2 rounded-xl font-semibold flex items-center gap-2 transition-all text-sm md:text-base">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
         </svg><span class="hidden sm:inline">Tambah Pengguna</span> <span class="sm:hidden">Tambah</span> </button>
       </div>
       <div class="bg-white rounded-2xl shadow-lg overflow-hidden overflow-x-auto">
        <table class="w-full">
         <thead class="bg-gray-50">
          <tr>
           <th class="px-4 md:px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Foto</th>
           <th class="px-4 md:px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Username</th>
           <th class="px-4 md:px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Nama</th>
           <th class="px-4 md:px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Kelas</th>
           <th class="px-4 md:px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Role</th>
           <th class="px-4 md:px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Aksi</th>
          </tr>
         </thead>
         <tbody id="usersTableBody" class="divide-y divide-gray-200"><!-- Users will be loaded here -->
         </tbody>
        </table>
        <div id="noUsersMessage" class="hidden p-8 text-center text-gray-500">
         <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
         </svg>
         <p class="text-lg font-medium">Belum ada data pengguna</p>
         <p class="text-sm">Klik "Tambah Pengguna" untuk menambahkan</p>
        </div>
       </div>
      </div><!-- Results Tab -->
      <div id="resultsTab" class="admin-tab hidden">
       <div class="flex items-center justify-between gap-4 mb-6 flex-wrap">
        <h2 class="text-xl md:text-2xl font-bold text-gray-800">Hasil Ujian</h2><button id="exportResultsBtn" class="bg-green-600 hover:bg-green-700 text-white px-3 md:px-4 py-2 md:py-2 rounded-xl font-semibold flex items-center gap-2 transition-all text-sm md:text-base">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
         </svg><span class="hidden sm:inline">Export Data</span> <span class="sm:hidden">Export</span> </button>
       </div>
       <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
        <div class="bg-white rounded-xl p-4 shadow">
         <p class="text-gray-500 text-sm">Total Peserta</p>
         <p id="totalParticipants" class="text-2xl font-bold text-gray-800">0</p>
        </div>
        <div class="bg-white rounded-xl p-4 shadow">
         <p class="text-gray-500 text-sm">Sudah Mengerjakan</p>
         <p id="completedCount" class="text-2xl font-bold text-green-600">0</p>
        </div>
        <div class="bg-white rounded-xl p-4 shadow">
         <p class="text-gray-500 text-sm">Rata-rata Skor</p>
         <p id="averageScore" class="text-2xl font-bold text-blue-600">0</p>
        </div>
        <div class="bg-white rounded-xl p-4 shadow">
         <p class="text-gray-500 text-sm">Skor Tertinggi</p>
         <p id="highestScore" class="text-2xl font-bold text-purple-600">0</p>
        </div>
       </div>
       <div class="bg-white rounded-2xl shadow-lg overflow-hidden overflow-x-auto">
        <table class="w-full">
         <thead class="bg-gray-50">
          <tr>
           <th class="px-4 md:px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase">No</th>
           <th class="px-4 md:px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase">Nama</th>
           <th class="px-4 md:px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase">Kelas</th>
           <th class="px-4 md:px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase">Skor</th>
           <th class="px-4 md:px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase">Benar</th>
           <th class="px-4 md:px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase">Waktu Selesai</th>
          </tr>
         </thead>
         <tbody id="resultsTableBody" class="divide-y divide-gray-200"><!-- Results will be loaded here -->
         </tbody>
        </table>
        <div id="noResultsMessage" class="hidden p-8 text-center text-gray-500">
         <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
         </svg>
         <p class="text-lg font-medium">Belum ada hasil ujian</p>
         <p class="text-sm">Hasil akan muncul setelah peserta menyelesaikan ujian</p>
        </div>
       </div>
      </div><!-- Settings Tab -->
      <div id="settingsTab" class="admin-tab hidden">
       <h2 class="text-xl md:text-2xl font-bold text-gray-800 mb-6">Pengaturan Ujian</h2>
       <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
        <h3 class="text-lg font-bold text-gray-800 mb-4">Import Soal dari File Word</h3>
        <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-4 mb-4">
         <div class="flex gap-3">
          <svg class="w-6 h-6 text-yellow-600 flex-shrink-0" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <div class="text-sm text-yellow-800">
           <p class="font-semibold mb-2">Format File Word (.docx):</p>
           <p class="mb-1">• Saat ini fitur import soal dari Word masih dalam pengembangan</p>
           <p class="mb-1">• Sementara, soal dapat ditambahkan langsung melalui kode aplikasi</p>
           <p>• Fitur import akan segera tersedia untuk memudahkan input soal</p>
          </div>
         </div>
        </div>
        <div class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center bg-gray-50">
         <svg class="w-16 h-16 mx-auto mb-4 text-gray-400" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
         </svg>
         <p class="text-gray-600 mb-2">Fitur Import Soal (Segera Hadir)</p>
         <p class="text-sm text-gray-500 mb-4">Upload file Word (.docx) dengan format soal yang telah ditentukan</p><button class="bg-gray-300 text-gray-500 px-6 py-3 rounded-xl font-semibold cursor-not-allowed" disabled> Pilih File Word </button>
         <p class="text-xs text-gray-400 mt-2">Fitur ini akan segera aktif</p>
        </div>
       </div>
       <div class="bg-white rounded-2xl shadow-lg p-6">
        <h3 class="text-lg font-bold text-gray-800 mb-4">Pengaturan Umum</h3>
        <form id="settingsForm" class="space-y-6">
         <div><label for="settingTitle" class="block text-sm font-semibold text-gray-700 mb-2">Judul Ujian</label> <input type="text" id="settingTitle" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all outline-none" value="TUC 1 TKA Kombel Kawula">
         </div>
         <div><label for="settingDuration" class="block text-sm font-semibold text-gray-700 mb-2">Durasi Ujian (menit)</label> <input type="number" id="settingDuration" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all outline-none" value="75" min="1" max="300">
         </div>
         <div><label for="settingQuestions" class="block text-sm font-semibold text-gray-700 mb-2">Jumlah Soal</label> <input type="number" id="settingQuestions" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all outline-none" value="0" min="0" readonly>
          <p class="text-xs text-gray-500 mt-1">Jumlah soal akan diperbarui otomatis sesuai jumlah soal yang ada</p>
         </div>
         <div class="flex items-center gap-3"><input type="checkbox" id="settingRandomize" class="w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500" checked> <label for="settingRandomize" class="text-sm font-medium text-gray-700">Acak urutan soal untuk setiap siswa</label>
         </div><button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-semibold transition-all"> Simpan Pengaturan </button>
        </form>
       </div>
      </div>
     </div>
    </div>
   </div><!-- Add/Edit User Modal -->
   <div id="userModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
    <div class="bg-white rounded-2xl p-8 w-full max-w-md mx-4 shadow-2xl">
     <h3 id="userModalTitle" class="text-xl font-bold text-gray-800 mb-6">Tambah Pengguna</h3>
     <form id="userForm" class="space-y-4"><input type="hidden" id="editUserId">
      <div><label for="userUsername" class="block text-sm font-semibold text-gray-700 mb-2">Username</label> <input type="text" id="userUsername" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 outline-none" required>
      </div>
      <div><label for="userPassword" class="block text-sm font-semibold text-gray-700 mb-2">Password</label> <input type="text" id="userPassword" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 outline-none" required>
      </div>
      <div><label for="userFullname" class="block text-sm font-semibold text-gray-700 mb-2">Nama Lengkap</label> <input type="text" id="userFullname" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 outline-none" required>
      </div>
      <div><label for="userKelas" class="block text-sm font-semibold text-gray-700 mb-2">Kelas</label> <input type="text" id="userKelas" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 outline-none" required>
      </div>
      <div><label for="userPhoto" class="block text-sm font-semibold text-gray-700 mb-2">URL Foto (opsional)</label> <input type="text" id="userPhoto" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 outline-none" placeholder="https://...">
      </div>
      <div class="flex gap-3 mt-6"><button type="button" id="cancelUserBtn" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 py-3 rounded-xl font-semibold transition-all"> Batal </button> <button type="submit" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-xl font-semibold transition-all"> Simpan </button>
      </div>
     </form>
    </div>
   </div><!-- Confirm Submit Modal -->
   <div id="confirmSubmitModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
    <div class="bg-white rounded-2xl p-8 w-full max-w-md mx-4 shadow-2xl text-center">
     <div class="w-16 h-16 bg-yellow-100 rounded-full mx-auto mb-4 flex items-center justify-center">
      <svg class="w-8 h-8 text-yellow-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
      </svg>
     </div>
     <h3 class="text-xl font-bold text-gray-800 mb-2">Kumpulkan Jawaban?</h3>
     <p id="confirmSubmitText" class="text-gray-600 mb-6">Anda telah menjawab 0 dari 0 soal. Yakin ingin mengumpulkan?</p>
     <div class="flex gap-3"><button id="cancelSubmitBtn" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 py-3 rounded-xl font-semibold transition-all"> Kembali </button> <button id="confirmSubmitBtn" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-3 rounded-xl font-semibold transition-all"> Ya, Kumpulkan </button>
     </div>
    </div>
   </div><!-- Delete Confirm Modal -->
   <div id="deleteConfirmModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
    <div class="bg-white rounded-2xl p-8 w-full max-w-md mx-4 shadow-2xl text-center">
     <div class="w-16 h-16 bg-red-100 rounded-full mx-auto mb-4 flex items-center justify-center">
      <svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
      </svg>
     </div>
     <h3 class="text-xl font-bold text-gray-800 mb-2">Hapus Pengguna?</h3>
     <p class="text-gray-600 mb-6">Data pengguna akan dihapus permanen dan tidak dapat dikembalikan.</p>
     <div class="flex gap-3"><button id="cancelDeleteBtn" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 py-3 rounded-xl font-semibold transition-all"> Batal </button> <button id="confirmDeleteBtn" class="flex-1 bg-red-600 hover:bg-red-700 text-white py-3 rounded-xl font-semibold transition-all"> Ya, Hapus </button>
     </div>
    </div>
   </div><!-- Loading Overlay -->
   <div id="loadingOverlay" class="fixed inset-0 loading-overlay hidden items-center justify-center z-50">
    <div class="bg-white rounded-2xl p-8 shadow-2xl text-center">
     <svg class="animate-spin h-12 w-12 text-blue-600 mx-auto mb-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle> <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
     </svg>
     <p class="text-gray-700 font-semibold" id="loadingText">Memuat data...</p>
    </div>
   </div><!-- Toast Notification -->
   <div id="toast" class="fixed bottom-6 right-6 bg-gray-800 text-white px-6 py-3 rounded-xl shadow-lg hidden transform transition-all duration-300 translate-y-full opacity-0 z-50">
    <div class="flex items-center gap-3"><span id="toastIcon">✓</span> <span id="toastMessage">Berhasil!</span>
    </div>
   </div>
  </div>
  <script>
    // =============================================
    // DATA AND STATE MANAGEMENT
    // =============================================
    
    // URL Google Apps Script untuk koneksi ke Google Sheets
    const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzNs8mwkXGbseMQFJM78k0608zvKgdPXpPiuajCGwdpz1PRovVtNOj-rShWBDebXi2JQg/exec';
    
    const defaultConfig = {
      app_title: 'TUC 1 TKA Kombel Kawula',
      exam_duration: '75',
      primary_color: '#2563eb',
      secondary_color: '#1e40af',
      accent_color: '#10b981'
    };
    
    let config = { ...defaultConfig };
    let allData = [];
    let currentUser = null;
    let currentQuestion = 0;
    let answers = {};
    let doubts = new Set();
    let timerInterval = null;
    let timeRemaining = 120 * 60;
    let questionOrder = [];
    let deleteTargetId = null;
    let isLoadingData = false;
    
    // Soal-soal pilihan ganda
    const questions = [
      {
        id: 1,
        type: 'single',
        question: 'Lita terlihat gugup saat membaca puisi di depan kelas. Makna kata "gugup" dalam kalimat di atas adalah….',
        options: [
          'percaya diri',
          'senang',
          'cemas',
          'bahagia'
        ],
        answer: 'cemas'
      },
      {
        id: 2,
        type: 'single',
        question: 'Gunung Merapi adalah gunung berapi teraktif di Jawa Tengah. Gunung ini sering meletus dan mengeluarkan lava pijar. Hampir setiap hari gunung ini mengeluarkan asap yang membumbung tinggi. Pasir dan batu hasil erupsi menjadi sumber perekonomian warga di lereng Merapi. Ide pokok dari bacaan tersebut adalah?',
        options: [
          'Gunung Merapi adalah gunung berapi aktif',
          'Sumber perekonomian warga lereng merapi',
          'Gunung Merapi sering meletus',
          'Keindahan alam gunung Merapi'
        ],
        answer: 'Gunung Merapi adalah gunung berapi aktif'
      },
      {
        id: 3,
        type: 'single',
        question: 'Disebuah hutan yang lebat, hiduplah seekor kancil cerdik, ia suka bermain di antara pohon tinggi dan sungai yang jernih. Latar tempat cerita di atas adalah ?',
        options: [
          'Sawah',
          'Hutan',
          'Kota',
          'Pantai'
        ],
        answer: 'Hutan'
      },
      {
        id: 4,
        type: 'multiple',
        question: 'Bacalah paragraf berikut! "Semangka yang rasanya manis dan berwarna merah umumnya memiliki ciri tertentu. Tangkainya yang kering kecokelatan menandakan semangka sudah matang dan siap panen. Pada permukaan kulit semangka yang matang sempurna terdapat bercak berwarna kuning tua. Semangka yang manis memiliki jaring-jaring cokelat di kulitnya. Selain itu, semangka yang matang dan berair biasanya berbentuk bulat dan terasa lebih berat." Apa gagasan pendukung paragraf tersebut? Pilihlah jawaban yang benar! Jawaban benar lebih dari satu.',
        options: [
          'Jaring-jaring coklat di kulit',
          'Ciri semangka manis dan merah',
          'Tangkai kering kecoklatan',
          'Semangka dipetik saat berwarna hijau'
        ],
        answer: [
          'Jaring-jaring coklat di kulit',
          'Ciri semangka manis dan merah',
          'Tangkai kering kecoklatan'
        ]
      },
      {
        id: 5,
        type: 'single',
        stimulus: `Tugas Kelompok
 
Suatu hari, guru Budi memberikan tugas kelompok. Budi dan dua temannya, Roni dan Tono, mendapatkan tugas membuat miniatur rumah dari stik es krim. Roni dan Tono sibuk bermain game, sementara Budi dengan tekun mengerjakan seluruh tugas itu sendirian.

Saat guru menanyakan bagaimana pembagian tugas mereka, Budi bisa saja bilang kalau mereka semua bekerja sama. Namun, ia memilih untuk berkata jujur. Ia menceritakan apa yang sebenarnya terjadi. Roni dan Tono pun merasa malu. Guru tidak marah, justru memberikan pengertian pada Roni dan Tono bahwa kejujuran Budi adalah hal yang harus dicontoh.

Meskipun harus mengerjakan tugas sendiri, Budi tidak merasa rugi. Ia merasa lega karena telah berkata jujur. Roni dan Tono akhirnya meminta maaf pada Budi. Sejak saat itu, mereka jadi lebih bertanggung jawab dan selalu bekerja sama dengan baik.`,
        question: 'Bagaimana sikap Roni dan Tono di akhir cerita?',
        options: [
          'Sibuk bermain game dan tidak mau bekerja sama dengan teman',
          'Lebih bertanggung jawab dan selalu bekerja sama dengan baik',
          'Meminta maaf dan tidak mengulangi perbuatan buruknya',
          'Menjadi lela dan mau mengerjakan tugas secara mandiri'
        ],
        answer: 'Lebih bertanggung jawab dan selalu bekerja sama dengan baik'
      },
      {
        id: 6,
        type: 'single',
        stimulus: `Tugas Kelompok
 
Suatu hari, guru Budi memberikan tugas kelompok. Budi dan dua temannya, Roni dan Tono, mendapatkan tugas membuat miniatur rumah dari stik es krim. Roni dan Tono sibuk bermain game, sementara Budi dengan tekun mengerjakan seluruh tugas itu sendirian.
Saat guru menanyakan bagaimana pembagian tugas mereka, Budi dihadapkan pada pilihan sulit. Namun, karena Budi adalah anak yang lurus hati, ia memilih untuk menceritakan apa yang sebenarnya terjadi tanpa menutup-nutupi kesalahan teman-temannya. Roni dan Tono pun merasa malu di depan kelas.
Guru tidak marah, justru memberikan pengertian pada Roni dan Tono bahwa sikap lurus hati yang dimiliki Budi adalah hal yang harus dicontoh oleh semua murid. Meskipun harus mengerjakan tugas sendiri, Budi tidak merasa rugi. Ia merasa lega karena telah berpegang pada kebenaran. Roni dan Tono akhirnya meminta maaf, dan sejak saat itu, mereka menjadi lebih bertanggung jawab serta selalu bekerja sama dengan baik.
`,
        question: 'Apa makna ungkapan "lurus hati" pada teks tersebut?',
        options: [
          'jujur',
          'berani',
          'ramah',
          'disiplin'
        ],
        answer: 'jujur'
      },
      {
        id: 7,
        type: 'truefalse',
        stimulus: `Tugas Kelompok
 
Suatu hari, guru Budi memberikan tugas kelompok. Budi dan dua temannya, Roni dan Tono, mendapatkan tugas membuat miniatur rumah dari stik es krim. Roni dan Tono sibuk bermain game, sementara Budi dengan tekun mengerjakan seluruh tugas itu sendirian.

Saat guru menanyakan bagaimana pembagian tugas mereka, Budi bisa saja bilang kalau mereka semua bekerja sama. Namun, ia memilih untuk berkata jujur. Ia menceritakan apa yang sebenarnya terjadi. Roni dan Tono pun merasa malu. Guru tidak marah, justru memberikan pengertian pada Roni dan Tono bahwa kejujuran Budi adalah hal yang harus dicontoh.

Meskipun harus mengerjakan tugas sendiri, Budi tidak merasa rugi. Ia merasa lega karena telah berkata jujur. Roni dan Tono akhirnya meminta maaf pada Budi. Sejak saat itu, mereka jadi lebih bertanggung jawab dan selalu bekerja sama dengan baik.`,
        question: 'Peristiwa sehari-hari apakah yang sesuai dengan penerapan nilai yang terkandung dalam teks tersebut? Pilihlah jawaban yang benar dengan memberi tanda centang (��) pada kolom yang sesuai!',
        statements: [
          { text: 'Diah menemukan uang di sekolah dan melaporkannya kepada guru.', answer: true },
          { text: 'Niko mengerjakan tugas ulangan Bahasa Indonesia tanpa menyontek.', answer: true },
          { text: 'Susi selalu membantu pekerjaan orang tuanya sepulang sekolah.', answer: false }
        ]
      },
      {
        id: 8,
        type: 'multiple',
        stimulus: `Anak berbakti adalah seorang anak yang selalu membantu orang tua dan mematuhi nasihat mereka, ia juga suka berbagi dengan teman-temannya.`,
        question: 'Pengertian anak berbakti berdasarkan teks di atas adalah? Pilihlah jawaban yang benar! Jawaban benar lebih dari satu.',
        options: [
          'Membantu orang tua',
          'Mematuhi nasihat orang tua',
          'Bermain dengan teman',
          'Berbagi dengan teman'
        ],
        answer: [
          'Membantu orang tua',
          'Mematuhi nasihat orang tua',
          'Berbagi dengan teman'
        ]
      },
      {
        id: 9,
        type: 'truefalse',
        stimulus: `Bunga melati adalah bunga nasional Indonesia yang mendapat julukan "Puspa Bangsa". Bunga ini memiliki warna putih yang indah dan harum baunya. Bunga ini melambangkan kesucian, kemurnian, keanggunan, dan kesederhanaan.`,
        question: 'Pernyataan berikut Benar (B) atau Salah (S):',
        statements: [
          { text: '1. Bunga melati memiliki julukan Puspa Bangsa', answer: true },
          { text: '2. Bunga melati adalah bunga internasional', answer: false },
          { text: '3. Bunga melati melambangkan kesucian dan kemurnian', answer: true }
        ]
      },
      {
        id: 10,
        type: 'multiple',
        stimulus: `Lomba Mendongeng
 
Kirana akan mengikuti lomba mendongeng. Ia memilih judul Kelinci dan Serigala. Malam demi malam, ia duduk di depan cermin, mengulang setiap intonasi dan mimik wajah. Suara seraknya berubah menjadi merdu, gerak tangannya yang kaku menjadi luwes menirukan gerakan berbagai hewan. Neneknya, satu-satunya penonton setianya, selalu tersenyum hangat dan mengangguk puas. "Ceritamu sudah hidup, Kirana," bisik Nenek suatu malam. Kata-kata itu memberinya kekuatan.
 
Hari perlombaan tiba. Jantungnya berdebar kencang seperti genderang perang. Panggung yang tampak begitu luas dan sorotan lampu yang menyilaukan seolah ingin melenyapkan keberaniannya. Namun, ia tetap mendongeng dengan percaya diri. Matanya menatap kerumunan. Ia melihat wajah-wajah yang terpukau dan tersenyum.
 
Ketika nama Kirana diumumkan sebagai juara pertama, senyum bahagia tampak di wajahnya. Langkahnya menuju panggung terasa ringan. Di tangannya tergenggam piala yang indah. Ia pun teringat Neneknya yang selalu memberinya semangat.`,
        question: 'Manakah yang termasuk kosakata umum pada teks tersebut? Pilihlah jawaban yang benar! Jawaban benar lebih dari satu.',
        options: [
          'Hewan',
          'menatap',
          'melihat'
        ],
        answer: [
          'Hewan',
          'melihat'
        ]
      },
      {
        id: 11,
        type: 'agree-disagree',
        stimulus: `Lomba Mendongeng
 
Kirana akan mengikuti lomba mendongeng. Ia memilih judul Kelinci dan Serigala. Malam demi malam, ia duduk di depan cermin, mengulang setiap intonasi dan mimik wajah. Suara seraknya berubah menjadi merdu, gerak tangannya yang kaku menjadi luwes menirukan gerakan berbagai hewan. Neneknya, satu-satunya penonton setianya, selalu tersenyum hangat dan mengangguk puas. "Ceritamu sudah hidup, Kirana," bisik Nenek suatu malam. Kata-kata itu memberinya kekuatan.
 
Hari perlombaan tiba. Jantungnya berdebar kencang seperti genderang perang. Panggung yang tampak begitu luas dan sorotan lampu yang menyilaukan seolah ingin melenyapkan keberaniannya. Namun, ia tetap mendongeng dengan percaya diri. Matanya menatap kerumunan. Ia melihat wajah-wajah yang terpukau dan tersenyum.
 
Ketika nama Kirana diumumkan sebagai juara pertama, senyum bahagia tampak di wajahnya. Langkahnya menuju panggung terasa ringan. Di tangannya tergenggam piala yang indah. Ia pun teringat Neneknya yang selalu memberinya semangat.

Setelah membaca teks tersebut, tiga murid berpendapat sebagai berikut!
 
Dina: "Agar aku menang seperti Kirana, aku perlu latihan sungguh-sungguh sehari sebelum mengikuti lomba."
 
Tari: "Hmm��� aku ingin seperti Kirana yang bersemangat latihan lomba jika hadiahnya besar."
 
Nani: "Aku ingin sehebat Kirana, untuk itu aku harus selalu bersungguh-sungguh agar berhasil."`,
        question: 'Pendapat siapa yang tepat untuk menggambarkan semangat untuk meneladani keberhasilan tokoh Kirana? Pilihlah Setuju atau Tidak Setuju untuk setiap pernyataan!',
        statements: [
          { text: 'Dina karena akan latihan sungguh-sungguh sehari sebelum lomba agar menang.', answer: false },
          { text: 'Tari karena akan bersemangat latihan ketika hadiahnya besar.', answer: false },
          { text: 'Nani karena akan berlatih dengan sungguh-sungguh agar berhasil.', answer: true }
        ]
      },
      {
        id: 12,
        type: 'single',
        stimulus: `Tanah longsor merupakan peristiwa geologi berupa perpindahan massa tanah, batuan, atau material rombakan lainnya menuruni lereng akibat pengaruh gaya gravitasi. Peristiwa ini umumnya terjadi pada daerah bertopografi curam dengan kondisi geologi dan <b>hidrologi</b> tertentu yang tidak stabil.`,
        question: 'Makna dari kata yang dicetak tebal adalah…',
        options: [
          'Peristiwa tentang daur air',
          'Ilmu tentang air di bawah tanah',
          'Ilmu yang mempelajari tentang tanah',
          'Ilmu yang mempelajari tentang jenis-jenis air'
        ],
        answer: 'Ilmu yang mempelajari tentang jenis-jenis air'
      },
      {
        id: 13,
        type: 'single',
        stimulus: `Ciri khas dari hewan ini terletak pada kantung di perut betinanya yang digunakan untuk membawa dan merawat anaknya yang masih sangat kecil, disebut joey. Hewan ini bergerak dengan cara melompat menggunakan kedua kaki belakangnya, sehingga mampu berpindah dengan cepat dan efisien.`,
        question: 'Berdasarkan teks tersebut hewan yang memiliki ciri-ciri seperti dalam teks adalah…',
        options: [
          'Marsupial',
          'Kanguru',
          'Beruang',
          'Katak'
        ],
        answer: 'Kanguru'
      },
      {
        id: 14,
        type: 'single',
        stimulus: `Dampak tanah longsor bersifat destruktif, mencakup kerusakan infrastruktur, perubahan morfologi lahan, gangguan sistem hidrologi, serta risiko korban jiwa. Oleh karena itu, upaya mitigasi teknis diperlukan, seperti analisis kestabilan lereng, sistem drainase lereng, perkuatan tanah (soil reinforcement), revegetasi, serta pemantauan geoteknik secara berkala untuk mengurangi potensi terjadinya tanah longsor.`,
        question: 'Revegetasi dalam upaya mitigasi tanah longsor berarti …',
        options: [
          'Penggalian tanah',
          'Pemadatan lereng',
          'Pembuatan saluran air',
          'Penanaman kembali tumbuh-tumbuhan'
        ],
        answer: 'Penanaman kembali tumbuh-tumbuhan'
      },
      {
        id: 15,
        type: 'multiple',
        stimulus: `Langit sore itu tiba-tiba menggelap ketika Raka menyadari bahwa buku catatan peninggalan ayahnya telah hilang dari dalam tas. Jantungnya berdegup kencang saat ia mengingat betapa pentingnya buku itu, berisi petunjuk terakhir yang belum sempat ia pahami. "Tidak mungkin��� aku menaruhnya di sini," gumamnya <b>panik</b> sambil mengacak-acak isi tas di tengah hujan yang mulai turun. Temannya, Dira, menatapnya cemas, sementara waktu terus berjalan dan mereka harus segera pergi sebelum gerbang stasiun ditutup. Dalam kebingungan dan tekanan itu, Raka dihadapkan pada pilihan sulit: mengejar seseorang yang dicurigainya mengambil buku tersebut atau menyelamatkan Dira yang mulai kelelahan dan ketakutan.`,
        question: 'Hal-hal yang dirasakan oleh tokoh utama sesuai dengan kata yang dicetak tebal adalah…',
        options: [
          'Dia merasa takut karena bahagia',
          'Tokoh utama merasa stres dan bingung',
          'Tokoh utama merasa gelisah dan cemas',
          'Tokoh utama semangat dan antusias'
        ],
        answer: [
          'Tokoh utama merasa stres dan bingung',
          'Tokoh utama merasa gelisah dan cemas'
        ]
      },
      {
        id: 16,
        type: 'single',
        stimulus: `Pohon ini memiliki batang berkayu dengan tinggi sekitar 2–5 meter. Daunnya berbentuk oval, berwarna hijau mengilap, dan tumbuh berhadapan. Bunganya berwarna putih, berukuran kecil, dan memiliki aroma harum. Setelah berbunga, tanaman ini menghasilkan buah berbentuk bulat kecil. Buah ini akan berubah warna dari hijau menjadi merah saat matang. Tanaman ini mudah tumbuh di daerah pegunungan dengan udara sejuk.`,
        question: 'Jenis pohon yang tepat sesuai dengan deskripsi pada teks tersebut adalah…',
        options: [
          'Kopi',
          'Jahe',
          'Durian',
          'Cengkeh'
        ],
        answer: 'Kopi'
      },
      {
        id: 17,
        type: 'multiple',
        stimulus: `Gunung berapi merupakan bentang alam yang terbentuk akibat aktivitas tektonik dan vulkanisme di dalam kerak bumi. Gunung ini memiliki saluran utama yang disebut pipa magma, yang menghubungkan dapur magma dengan permukaan bumi. Ketika tekanan magma meningkat, terjadi <b>erupsi</b> vulkanik yang mengeluarkan material seperti lava, abu vulkanik, lapili, dan gas vulkanik.`,
        question: 'Berikut yang merupakan kata yang dapat menggantikan kata yang bercetak tebal adalah…',
        options: [
          'Semburan',
          'Aliran',
          'Letusan',
          'Guguran'
        ],
        answer: [
          'Semburan',
          'Letusan'
        ]
      },
      {
        id: 18,
        type: 'truefalse',
        stimulus: `Tempat ini terbentuk melalui proses alam seperti gelombang laut, arus laut, dan pasang surut yang berlangsung secara terus-menerus. Proses ini menyebabkan terjadinya abrasi dan sedimentasi yang memengaruhi bentuk garisnya. Selain itu, wilayah ini menjadi habitat berbagai ekosistem penting, seperti terumbu karang, padang lamun, dan hutan mangrove. Dari segi ekonomi, tempat ini dimanfaatkan sebagai kawasan pariwisata, perikanan, dan transportasi laut. Namun, aktivitas manusia yang tidak terkendali, seperti pencemaran dan pembangunan berlebihan, dapat merusak ekosistem dan mengancam keberlangsungannya.`,
        question: 'Analisa pernyataan berikut benar atau salah berdasarkan tempat yang diterangkan dalam teks!',
        statements: [
          { text: 'Salah satu provinsi yang memiliki tempat tersebut dan terkenal di dunia adalah Bali', answer: true },
          { text: 'Tempat ini sering dijadikan tempat festival lomba layang-layang', answer: true },
          { text: 'Kita dapat menikmati salju yang banyak di tempat ini', answer: false },
          { text: 'Anak-anak dapat bermain membuat istana pasir di sini', answer: true }
        ]
      },
      {
        id: 19,
        type: 'single',
        stimulus: `Klasifikasi Tumbuhan

Tumbuhan-tumbuhan dikelompokkan berdasarkan klasifikasinya dan tempat hidupnya. Mulai dari tumbuhan mesofit, xerofit, hidrofit, dan halofit. Mesofit merupakan kelompok tumbuhan darat yang di lingkungan dengan persediaan air rata-rata. Hal ini berarti bahwa tumbuhan mesofit hidup di tempat yang memiliki air normal atau tidak terlalu kering dan enggak terlalu basah. Tumbuhaan mesofit hidup di lingkungaan yang menguntungkan dan lebih stabil. Hal ini dikarenan tempat hidup tumbuhan mesofit yang memiliki suhu yang tidak terlalu tinggi ataupun terlalu rendah. Contoh dari tumbuhan mesofit adalah jagung, gandum, pisang, papaya, bluberi, semanggi, mangga, rambutan, bunga matahari, bunga mawar, bunga tulip, dan bunga ester. 

Higrofit merupakan kelompok tumbuhan yang hidup di lingkungan lembap atau berkadar air tinggi tetapi tidak terendam air. Higrofit memiliki batang lunak dan kerdil, akar rimpang yang lunak, laju transpirasinya rendah, dan struktur pori-pori untuk menguapkan air disebut sebagai hidatoda. Contoh tumbuhan higrofit adalah keladi, talas, pakis, paku, aroid, lumut, anggrek, dan begonia.

Hidrofit merupakan tumbuhan yang hidup di lingkungan basah atau berair. Tumbuhan ini hidup di kadar air yang tinggi dan terendam secara berkala, ada yang terus-menerus, dan ada yang tenggelam. Jenis tanaman ini tidak memiliki stomata, saluran udara yang membuatnya mengambang, dan lapisan lilin yang melindunginya dari pembusukan karena terendam air. Contoh dari tanaman hidrofit ini yaitu, hydrilla, valisineria, lili air, lemna, coontail, rumput belut, eceng gondok, dan teratai.

Halofit merupakan tumbuhan yang hidup di lingkungan yang memiliki kadar Nacl2, MgCl2, MgSO4, atau air asin. Biasanya, tumbuhan ini memiliki batang dan daun berlapis lilin, akar adventif yang kuat, perkecambahan vivipar, dan kemampuan untuk menyaring garam dan mengeluarkan kelebihan garam. Contoh tumbuhannya adalah pohon bakau atau mangrove, rumput gajah, heritera atau dungun, semak garam, dan glasswort.

Xerofit merupakan tumbuhan yang hidup di tempat yang kering dan beradaptasi untuk mencegah kehilangan air. Adaptasi tumbuhan ini membuatnya hidup di lingkungan yang kekurangan air dan juga panas. Contoh tumbuhannya adalah kaktus, lidah buaya, akasia, buah nanas, adenium, buah naga, pir berduri, lavender gurun, dan dandelion.`,
        question: 'Bagan mana yang sesuai untuk menggambarkan informasi pada teks tersebut?',
        options: [
          'Pilihan A',
          'Pilihan B',
          'Pilihan C',
          'Pilihan D'
        ],
        answer: 'Pilihan D',
        images: [
          { label: 'A', url: 'https://i.ibb.co.com/k2wNm5CT/pilihan-a.jpg' },
          { label: 'B', url: 'https://i.ibb.co.com/YBzdT95g/Pilihan-b.jpg' },
          { label: 'C', url: 'https://i.ibb.co.com/XZ7Zyyty/opsi-c.jpg' },
          { label: 'D', url: 'https://i.ibb.co.com/Jjd0qp7j/opsi-d.jpg' }
        ]
      },
      {
        id: 20,
        type: 'single',
        stimulus: `Pangeran Candra dan Cincin Berlian Palsu

Pangeran Candra adalah putra mahkota Kerajaan Bintang Kejora. Ia dikenal sebagai anak yang baik hati. Tetapi sifat polosnya membuat ia mudah percaya pada siapa saja. Pengawal pribadinya, Miko, sering kali mengkhawatirkan hal ini.

Suatu hari, seorang pedagang asing dengan pakaian mewah datang ke istana. Ia membawa kotak dihiasi kain beludru merah. Pedagang itu mempersembahkan sebuah cincin berlian yang berkilauan kepada Pangeran Candra. "Hamba ingin memberikan berlian ini sebagai tanda persahabatan," katanya dengan senyum yang ramah.

Miko merasakan ada yang aneh. Ia berbisik kepada Pangeran, "Hati-hati, Pangeran. Hadiah gratis bisa jadi jebakan."

Pangeran Candra menepisnya. "Aku percaya padanya, Miko. Lihatlah senyumnya. Dia pasti orang baik."

Melihat Pangeran Candra yang polos, pedagang itu melanjutkan tipuannya. "Sebagai teman, bolehkah hamba melihat keindahan ruang harta kerajaan yang begitu terkenal?"

Tanpa pikir panjang, Pangeran Candra mengangguk setuju dan membawa pedagang itu ke ruang penyimpanan. Miko tidak bisa berbuat apa-apa selain mengikutinya dengan cemas.

Setelah pedagang itu pergi, Pangeran Candra kembali ke kamarnya dengan perasaan gembira. Ia meletakkan cincin berlian itu di meja. Namun, berlian itu mulai pudar. Kilauannya redup dan berubah menjadi kepingan kaca biasa. Pada saat yang sama, seorang penjaga datang dan melaporkan bahwa sebagian harta kerajaan telah hilang. Pangeran Candra terkejut dan sedih. Ia menyadari bahwa ia telah ditipu dan merasa menyesal. Sejak peristiwa itu, Pangeran Candra lebih berhati-hati ketika bertemu dengan orang yang belum dikenalnya.`,
        image: 'https://i.ibb.co.com/v4nXVYPW/Gambar-Ilustrasi.jpg',
        question: 'Apa amanat cerita tersebut?',
        options: [
          'Sebaiknya kita selalu mengikuti apa yang menjadi kata hati kita.',
          'Sebaiknya kita tidak mudah tergoda oleh berbagai macam perhiasan.',
          'Sebaiknya kita tidak mudah percaya kepada orang yang belum kita kenal.',
          'Kita harus selalu berhati-hati dalam bertindak agar tidak merugikan orang lain.'
        ],
        answer: 'Sebaiknya kita tidak mudah percaya kepada orang yang belum kita kenal.'
      },
      {
        id: 21,
        type: 'agree-disagree',
        stimulus: `Pangeran Candra dan Cincin Berlian Palsu

Pangeran Candra adalah putra mahkota Kerajaan Bintang Kejora. Ia dikenal sebagai anak yang baik hati. Tetapi sifat polosnya membuat ia mudah percaya pada siapa saja. Pengawal pribadinya, Miko, sering kali mengkhawatirkan hal ini.

Suatu hari, seorang pedagang asing dengan pakaian mewah datang ke istana. Ia membawa kotak dihiasi kain beludru merah. Pedagang itu mempersembahkan sebuah cincin berlian yang berkilauan kepada Pangeran Candra. "Hamba ingin memberikan berlian ini sebagai tanda persahabatan," katanya dengan senyum yang ramah.

Miko merasakan ada yang aneh. Ia berbisik kepada Pangeran, "Hati-hati, Pangeran. Hadiah gratis bisa jadi jebakan."

Pangeran Candra menepisnya. "Aku percaya padanya, Miko. Lihatlah senyumnya. Dia pasti orang baik."

Melihat Pangeran Candra yang polos, pedagang itu melanjutkan tipuannya. "Sebagai teman, bolehkah hamba melihat keindahan ruang harta kerajaan yang begitu terkenal?"

Tanpa pikir panjang, Pangeran Candra mengangguk setuju dan membawa pedagang itu ke ruang penyimpanan. Miko tidak bisa berbuat apa-apa selain mengikutinya dengan cemas.

Setelah pedagang itu pergi, Pangeran Candra kembali ke kamarnya dengan perasaan gembira. Ia meletakkan cincin berlian itu di meja. Namun, berlian itu mulai pudar. Kilauannya redup dan berubah menjadi kepingan kaca biasa. Pada saat yang sama, seorang penjaga datang dan melaporkan bahwa sebagian harta kerajaan telah hilang. Pangeran Candra terkejut dan sedih. Ia menyadari bahwa ia telah ditipu dan merasa menyesal. Sejak peristiwa itu, Pangeran Candra lebih berhati-hati ketika bertemu dengan orang yang belum dikenalnya.`,
        question: 'Apa contoh peristiwa dalam kehidupan sehari-hari berdasarkan kejadian yang dialami Pangeran Candra pada cerita tersebut? Tentukan Sesuai atau Tidak Sesuai untuk setiap pernyataan berikut!',
        statements: [
          { text: 'Joni ditipu jutaan rupiah setelah mengikuti permintaan seseorang yang meneleponnya dengan dalih mendapatkan hadiah undian.', answer: true },
          { text: 'Pak Bondan termakan rayuan penjual cat palsu yang menawarkan harga murah dengan alasan sisa proyek.', answer: true },
          { text: 'Bu Bekti kehilangan dompet berisi uang jutaan rupiah ketika berbelanja di pasar yang ramai oleh pengunjung.', answer: false }
        ]
      }

    ,

    {
  id: 22,
  type: 'single',
  stimulus: 'Padma dan Ibna baru saja kembali dari darmawisata ke kota Cirebon. Keduanya dipilih mewakili sekolah karena memenangkan lomba karya tulis yang bertemakan Cinta Produk Indonesia. Karya mereka yang mengangkat batik dari kota Cirebon, membawa mereka mengunjungi kota kecil itu. Bersama beberapa pemenang dari sekolah lain, Padma dan Ibna banyak mendapatkan pengalaman menakjubkan selama berada di kota udang itu.',
  question: 'Ringkasan dari paragraf di atas adalah…',
  options: ['Padma dan Ibna memenangkan lomba menulis tentang batik dari kota Cirebon sehingga mereka mendapat kesempatan mengunjungi kota itu bersama pemenang lainnya.', 'Padma dan Ibna menulis tentang batik dari kota Cirebon karena mereka sangat cinta pada Produk Indonesia.', 'Para pemenang lomba menulis tentang Cinta Produk Indonesia mendapat beragam hadiah dari panitia lomba.', 'Amir dan Desy sangat senang karena mereka berhasil menjuarai lomba menulis tentang Cinta Produk Indonesia yang diadakan di Kota Cirebon.'],
  answer: 'Padma dan Ibna memenangkan lomba menulis tentang batik dari kota Cirebon sehingga mereka mendapat kesempatan mengunjungi kota itu bersama pemenang lainnya.'
},
{
  id: 23,
  type: 'single',
  stimulus: 'Mawar adalah bunga yang sangat popular di seluruh dunia. Bunga ini dikenal karena keindahan kelopaknya yang berlapis dan aromanya yang harum semerbak. Mawar sering kali menjadi simbol cinta, keindahan, dan keberhasilan. Ada berbagai macam warna mawar, mulai daari merah putih, pink hingga kuning, yang masing-masing memiliki arti berbeda. Mawar merah melambangkan cinta sejati, sementara mawar putih melambangkan kesucian dan kepolosan.',
  question: 'Informasi tersurat yang mengatakan arti mawar putih adalah…',
  options: ['Cinta sejati dan kerahasiaan', 'Simbol keindahan seluruh dunia', 'Kepolosan dan kesucian', 'Aroma yang harum semerbak'],
  answer: 'Kepolosan dan kesucian'
},
{
  id: 24,
  type: 'single',
  stimulus: 'Mawar adalah bunga yang sangat popular di seluruh dunia. Bunga ini dikenal karena keindahan kelopaknya yang berlapis dan aromanya yang harum semerbak. Mawar sering kali menjadi simbol cinta, keindahan, dan keberhasilan. Ada berbagai macam warna mawar, mulai daari merah putih, pink hingga kuning, yang masing-masing memiliki arti berbeda. Mawar merah melambangkan cinta sejati, sementara mawar putih melambangkan kesucian dan kepolosan.',
  question: 'Berdasarkan teks, warna yang melambangkan cinta sejati adalah…',
  options: ['Kuning', 'Merah', 'Pink', 'Putih'],
  answer: 'Merah'
},
{
  id: 25,
  type: 'single',
  stimulus: 'Mawar adalah bunga yang sangat popular di seluruh dunia. Bunga ini dikenal karena keindahan kelopaknya yang berlapis dan aromanya yang harum semerbak. Mawar sering kali menjadi simbol cinta, keindahan, dan keberhasilan. Ada berbagai macam warna mawar, mulai daari merah putih, pink hingga kuning, yang masing-masing memiliki arti berbeda. Mawar merah melambangkan cinta sejati, sementara mawar putih melambangkan kesucian dan kepolosan.',
  question: 'Apa saja warna bunga mawar berdasarkan teks?',
  options: ['Merah dan putih', 'Pink dan kuning', 'Putih, merah, dan kuning', 'Kuning, pink, putih, dan merah'],
  answer: 'Kuning, pink, putih, dan merah'
},{
  id: 26,
  type: 'multiple',
  stimulus: 'Sampah plastik menjadi isu lingkungan global karena sulit terurai. Salah satu solusi efektif adalah daur ulang. Prosesnya melibatkan pemilihan, pencucian, penghancuran menjadi serpihan kecil, lalu dilebur menjadi biji plastik (pellet). Biji plastik ini kemudian bisa diolah menjadi produk baru seperti botol, serat kain atau furniture. Mengurangi penggunaan plastik sekali pakai dan membawa tas belanja sendiri adalah langkah preventif penting.',
  question: 'Berdasarkan teks di atas, berilah tanda centang untuk pernyataan yang benar (jawaban lebih dari satu)!',
  options: [
    'Membuang sampah plastik ke sungai untuk mengurangi tumpukan sampah di daratan.',
    'Membawa tas sendiri saat berbelanja di pasar.',
    'Memilah sampah plastik dan sampah organik selalu di buang.',
    'Menggunakan botol minum isi ulang dari pada botol plastik sekali pakai.'
  ],
  answer: [
          'Membawa tas sendiri saat berbelanja di pasar.',
          'Memilah sampah plastik dan sampah organik selalu di buang.','Menggunakan botol minum isi ulang dari pada botol plastik sekali pakai.'
        ]
},{
  id: 27,
  type: 'multiple',
  stimulus: 'Sampah plastik menjadi isu lingkungan global karena sulit terurai. Salah satu solusi efektif adalah daur ulang. Prosesnya melibatkan pemilihan, pencucian, penghancuran menjadi serpihan kecil, lalu dilebur menjadi biji plastik (pellet). Biji plastik ini kemudian bisa diolah menjadi produk baru seperti botol, serat kain atau furniture. Mengurangi penggunaan plastik sekali pakai dan membawa tas belanja sendiri adalah langkah preventif penting.',
  question: 'Bagan yang paling sesuai untuk menggambarkan hubungan antara "sampah plastik" dan "produk baru" (jawaban lebih dari satu)!',
  options: [
    'Sampah plastik → Pemilihan → Pencucian → Penghancuran → Peleburan → Biji Plastik → Produk Baru.',
    'Sampah plastik → Polusi → Produk baru.',
    'Sampah plastik → Pencemaran lingkungan.',
    'Sampah plastik → Daur ulang → Produk baru.'
  ],
  answer: ['Sampah plastik → Pemilihan → Pencucian → Penghancuran → Peleburan → Biji Plastik → Produk Baru.','Sampah plastik → Daur ulang → Produk baru.']
},{
  id: 28,
  type: 'truefalse',
  stimulus: 'Pada tahun 2024, SD Nusantara mengadakan kegiatan Kemah Persahabatan di Hutan Pinus, Kabupaten Malang. Acara ini berlangsung selama dua hari, dimulai pada tanggal 14 hingga 15 April. Seluruh siswa kelas 6 diwajibkan mengikuti kemah ini sebagai bagian dari kurikulum sekolah. Kegiatan difokuskan pada pengenalan lingkungan dan kerja sama tim.',
  question: 'Berdasarkan teks di atas berilah tanda centang (✓) untuk pernyataan di bawah ini!',
  statements: [
    { text: 'Kemah Persahabatan SD Nusantara diadakan pada tahun 2023.', answer: false },
    { text: 'Lokasi kemah di laksanakan di Hutan Pinus, Kabupaten Malang.', answer: true },
    { text: 'Seluruh siswa kelas enam diwajibkan mengikuti kemah tersebut.', answer: true }
  ]
},{
  id: 29,
  type: 'single',
  stimulus: 'Pak Slamet mengusap keringat di dahinya, matanya menatap hamparan sawah yang membentang di depannya. Padi-padi itu sudah menguning. Pertanda waktu panen telah tiba.\n\nDulu, ia pernah merantau ke kota, mencoba peruntungan sebagai buruh pabrik. Namun, hati dan pikirannya selalu tertuju pada sawah. Melihat air irigasi yang mengalir jernih dan hamparan sawah yang luas adalah hal-hal yang tidak pernah ia temukan di kota. Ia pun memutuskan untuk kembali.\n\nBagi Pak Slamet, menjadi petani bukanlah sekadar pekerjaan, melainkan sebuah panggilan jiwa. Setiap bulir padi yang ia tanam adalah harapan, setiap tetes keringat adalah doa. Ia percaya, tanah tidak pernah ingkar janji. Jika diolah dengan hati, ia akan memberikan hasil yang terbaik.\n\nPagi itu, ia bersama warga desa lainnya mulai turun ke sawah. Mereka bergotong royong, saling membantu memanen padi. Panen kali ini berhasil. Hati Pak Slamet dipenuhi rasa syukur saat panen tiba. Ia tahu, kerja kerasnya tidak sia-sia.',
  question: 'Apakah objek tempat yang tepat pada teks tersebut?',
  options: [
    'kota',
    'pabrik',
    'irigasi',
    'sawah'
  ],
  answer: 'sawah'
},{
  id: 30,
  type: 'agree-disagree',
  stimulus: 'Pak Slamet mengusap keringat di dahinya, matanya menatap hamparan sawah yang membentang di depannya. Padi-padi itu sudah menguning. Pertanda waktu panen telah tiba.\n\nDulu, ia pernah merantau ke kota, mencoba peruntungan sebagai buruh pabrik. Namun, hati dan pikirannya selalu tertuju pada sawah. Melihat air irigasi yang mengalir jernih dan hamparan sawah yang luas adalah hal-hal yang tidak pernah ia temukan di kota. Ia pun memutuskan untuk kembali.\n\nBagi Pak Slamet, menjadi petani bukanlah sekadar pekerjaan, melainkan sebuah panggilan jiwa. Setiap bulir padi yang ia tanam adalah harapan, setiap tetes keringat adalah doa. Ia percaya, tanah tidak pernah ingkar janji. Jika diolah dengan hati, ia akan memberikan hasil yang terbaik.\n\nPagi itu, ia bersama warga desa lainnya mulai turun ke sawah. Mereka bergotong royong, saling membantu memanen padi. Panen kali ini berhasil. Hati Pak Slamet dipenuhi rasa syukur saat panen tiba. Ia tahu, kerja kerasnya tidak sia-sia.\n\nSetelah membaca teks tersebut, tiga murid berpendapat sebagai berikut!\nAlex: "Wah, petani itu hebat, ya! Mau bekerja keras agar panennya berhasil."\nBeni: "Aku terharu dengan petani yang memilih tinggal di desa meskipun minim fasilitas."\nTio: "Aku salut pada petani yang selalu mensyukuri hasil panen mereka."',
  question: 'Pendapat siapa yang tepat untuk menggambarkan perasaan bangga pada petani setelah membaca teks? Tentukan Setuju atau Tidak Setuju untuk setiap pernyataan berikut!',
  statements: [
    { text: 'Alex karena mengakui kehebatan petani yang bekerja keras agar panen berhasil.', answer: true },
    { text: 'Beni karena tidak semua orang mau tinggal di desa.', answer: false },
    { text: 'Tio karena menunjukkan rasa hormat kepada petani yang selalu bersyukur ketika panen.', answer: true }
  ]
}];
    
    // =============================================
    // GOOGLE SHEETS API FUNCTIONS
    // =============================================
    
    function showLoading(text = 'Memuat data...') {
      document.getElementById('loadingText').textContent = text;
      document.getElementById('loadingOverlay').classList.remove('hidden');
      document.getElementById('loadingOverlay').classList.add('flex');
    }
    
    function hideLoading() {
      document.getElementById('loadingOverlay').classList.add('hidden');
      document.getElementById('loadingOverlay').classList.remove('flex');
    }
    
    async function fetchAllData() {
      if (isLoadingData) return;
      isLoadingData = true;
      
      try {
        const response = await fetch(`${GOOGLE_SCRIPT_URL}?action=getAllData&t=${Date.now()}`);
        const result = await response.json();
        
        if (result.success) {
          allData = result.data;
          return true;
        } else {
          throw new Error(result.error || 'Gagal mengambil data');
        }
      } catch (error) {
        console.error('Error fetching data:', error);
        showToast('Gagal memuat data dari spreadsheet', false);
        return false;
      } finally {
        isLoadingData = false;
      }
    }
    
    async function addUserToSheet(userData) {
      try {
        showLoading('Menyimpan pengguna...');
        
        const response = await fetch(`${GOOGLE_SCRIPT_URL}?action=addUser`, {
          method: 'POST',
          body: JSON.stringify(userData)
        });
        
        const result = await response.json();
        hideLoading();
        
        if (result.success) {
          await fetchAllData();
          return true;
        } else {
          throw new Error(result.message || 'Gagal menambah user');
        }
      } catch (error) {
        hideLoading();
        console.error('Error adding user:', error);
        showToast(error.message || 'Gagal menambah pengguna', false);
        return false;
      }
    }
    
    async function updateUserInSheet(userData) {
      try {
        showLoading('Memperbarui pengguna...');
        
        const response = await fetch(`${GOOGLE_SCRIPT_URL}?action=updateUser`, {
          method: 'POST',
          body: JSON.stringify(userData)
        });
        
        const result = await response.json();
        hideLoading();
        
        if (result.success) {
          await fetchAllData();
          return true;
        } else {
          throw new Error(result.message || 'Gagal update user');
        }
      } catch (error) {
        hideLoading();
        console.error('Error updating user:', error);
        showToast(error.message || 'Gagal memperbarui pengguna', false);
        return false;
      }
    }
    
    async function deleteUserFromSheet(username) {
      try {
        showLoading('Menghapus pengguna...');
        
        const response = await fetch(`${GOOGLE_SCRIPT_URL}?action=deleteUser`, {
          method: 'POST',
          body: JSON.stringify({ username })
        });
        
        const result = await response.json();
        hideLoading();
        
        if (result.success) {
          await fetchAllData();
          return true;
        } else {
          throw new Error(result.message || 'Gagal hapus user');
        }
      } catch (error) {
        hideLoading();
        console.error('Error deleting user:', error);
        showToast(error.message || 'Gagal menghapus pengguna', false);
        return false;
      }
    }
    
    async function saveResultToSheet(resultData) {
      try {
        showLoading('Menyimpan hasil ujian...');
        
        const response = await fetch(`${GOOGLE_SCRIPT_URL}?action=saveResult`, {
          method: 'POST',
          body: JSON.stringify(resultData)
        });
        
        const result = await response.json();
        hideLoading();
        
        if (result.success) {
          await fetchAllData();
          return true;
        } else {
          throw new Error(result.message || 'Gagal simpan hasil');
        }
      } catch (error) {
        hideLoading();
        console.error('Error saving result:', error);
        showToast(error.message || 'Gagal menyimpan hasil ujian', false);
        return false;
      }
    }
    
    // =============================================
    // UTILITY FUNCTIONS
    // =============================================
    
    function showToast(message, isSuccess = true) {
      const toast = document.getElementById('toast');
      const toastIcon = document.getElementById('toastIcon');
      const toastMessage = document.getElementById('toastMessage');
      
      toastIcon.textContent = isSuccess ? '✓' : '��';
      toastMessage.textContent = message;
      toast.classList.remove('hidden', 'translate-y-full', 'opacity-0');
      toast.classList.add('translate-y-0', 'opacity-100');
      toast.style.backgroundColor = isSuccess ? '#059669' : '#dc2626';
      
      setTimeout(() => {
        toast.classList.add('translate-y-full', 'opacity-0');
        setTimeout(() => toast.classList.add('hidden'), 300);
      }, 3000);
    }
    
    function shuffleArray(array) {
      const shuffled = [...array];
      for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
      }
      return shuffled;
    }
    
    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = seconds % 60;
      return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
    }
    
    function getUsers() {
      return allData.filter(d => d.type === 'user');
    }
    
    function getResults() {
      return allData.filter(d => d.type === 'result');
    }
    
    // =============================================
    // PAGE NAVIGATION
    // =============================================
    
    function showPage(pageId) {
      const pages = ['loginPage', 'adminLoginPage', 'examPage', 'resultPage', 'adminPanel'];
      pages.forEach(page => {
        const el = document.getElementById(page);
        if (page === pageId) {
          el.classList.remove('hidden');
          el.classList.add('flex');
        } else {
          el.classList.add('hidden');
          el.classList.remove('flex');
        }
      });
    }
    
    // =============================================
    // LOGIN HANDLERS
    // =============================================
    
    async function handleStudentLogin(e) {
      e.preventDefault();
      
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value.trim();
      const loginError = document.getElementById('loginError');
      const loginBtn = document.getElementById('loginBtn');
      const loginBtnText = document.getElementById('loginBtnText');
      const loginBtnLoading = document.getElementById('loginBtnLoading');
      
      loginBtnText.classList.add('hidden');
      loginBtnLoading.classList.remove('hidden');
      loginBtn.disabled = true;
      
      // Fetch latest data from spreadsheet
      await fetchAllData();
      
      setTimeout(() => {
        const users = getUsers();
        const user = users.find(u => u.username === username && u.password === password && u.role !== 'admin');
        
        if (user) {
          currentUser = user;
          loginError.classList.add('hidden');
          startExam();
        } else {
          loginError.classList.remove('hidden');
        }
        
        loginBtnText.classList.remove('hidden');
        loginBtnLoading.classList.add('hidden');
        loginBtn.disabled = false;
      }, 500);
    }
    
    async function handleAdminLogin(e) {
      e.preventDefault();
      
      const username = document.getElementById('adminUsername').value.trim();
      const password = document.getElementById('adminPassword').value.trim();
      const loginError = document.getElementById('adminLoginError');
      
      showLoading('Memverifikasi admin...');
      await fetchAllData();
      hideLoading();
      
      const users = getUsers();
      const adminUser = users.find(u => u.username === username && u.password === password && u.role === 'admin');
      
      if (adminUser) {
        loginError.classList.add('hidden');
        showPage('adminPanel');
        renderAdminData();
      } else {
        loginError.classList.remove('hidden');
      }
    }
    
    // =============================================
    // EXAM FUNCTIONS
    // =============================================
    
    function startExam() {
      if (questions.length === 0) {
        showToast('Soal belum tersedia. Hubungi admin untuk memperbarui soal.', false);
        return;
      }
      
      answers = {};
      doubts = new Set();
      currentQuestion = 0;
      timeRemaining = parseInt(config.exam_duration || defaultConfig.exam_duration) * 60;
      questionOrder = shuffleArray([...Array(questions.length).keys()]);
      
      document.getElementById('userName').textContent = currentUser.name;
      document.getElementById('userClass').textContent = currentUser.kelas;
      document.getElementById('userPhoto').src = currentUser.photo || '';
      document.getElementById('examTitle').textContent = config.app_title || defaultConfig.app_title;
      
      showPage('examPage');
      
      // Show desktop nav panel on desktop
      const navPanel = document.getElementById('questionNavPanel');
      if (window.innerWidth >= 768) {
        navPanel.classList.remove('hidden');
        navPanel.classList.add('flex');
      }
      
      renderQuestion();
      renderQuestionNav();
      startTimer();
      updateProgress();
    }
    
    function startTimer() {
      if (timerInterval) clearInterval(timerInterval);
      
      const timerEl = document.getElementById('timer');
      const timerDisplay = document.getElementById('timerDisplay');
      
      timerInterval = setInterval(() => {
        timeRemaining--;
        timerEl.textContent = formatTime(timeRemaining);
        
        if (timeRemaining <= 300) {
          timerDisplay.classList.add('timer-warning');
          timerDisplay.style.backgroundColor = 'rgba(239, 68, 68, 0.3)';
        }
        
        if (timeRemaining <= 0) {
          clearInterval(timerInterval);
          submitExam();
        }
      }, 1000);
    }
    
    function renderQuestion() {
      const qIndex = questionOrder[currentQuestion];
      const q = questions[qIndex];
      const container = document.getElementById('questionContainer');
      
      let html = `
        <div class="flex items-center gap-3 mb-6">
          <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-lg text-sm font-semibold">
            Soal ${currentQuestion + 1} dari ${questions.length}
          </span>
          <span class="bg-gray-100 text-gray-600 px-3 py-1 rounded-lg text-sm">
            ${getQuestionTypeLabel(q.type)}
          </span>
          ${doubts.has(qIndex) ? '<span class="bg-yellow-100 text-yellow-700 px-3 py-1 rounded-lg text-sm font-semibold">⚠️ Ragu-ragu</span>' : ''}
        </div>
      `;
      
      // Tampilkan stimulus bacaan jika ada
      if (q.stimulus) {
        html += `
          <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6 rounded">
            <p class="text-xs text-blue-600 font-semibold mb-2">📖 BACAAN</p>
            <div class="text-sm text-gray-700 leading-relaxed whitespace-pre-wrap">${q.stimulus}</div>
          </div>
        `;
      }
      
      // Tampilkan gambar jika ada
      if (q.image) {
        html += `
          <div class="mb-6 bg-gray-100 rounded-lg overflow-hidden flex items-center justify-center min-h-64">
            <img src="${q.image}" alt="Pertanyaan" class="max-w-full h-auto max-h-96 object-contain" loading="lazy"
              onerror="console.error('Image failed to load:', this.src); this.style.background='#f3f4f6'; this.alt='Gambar tidak dapat dimuat';">
          </div>
        `;
      }
      
      html += `<div class="text-lg text-gray-800 mb-6 leading-relaxed font-medium">${q.question}</div>`;
      
      const savedAnswer = answers[qIndex];
      
      switch(q.type) {
        case 'single':
          html += renderSingleChoice(q, savedAnswer);
          break;
        case 'multiple':
          html += renderMultipleChoice(q, savedAnswer);
          break;
        case 'short':
          html += renderShortAnswer(q, savedAnswer);
          break;
        case 'matching':
          html += renderMatching(q, savedAnswer);
          break;
        case 'truefalse':
          html += renderTrueFalse(q, savedAnswer);
          break;
        case 'agree-disagree':
          html += renderAgreeDisagree(q, savedAnswer);
          break;
      }
      
      container.innerHTML = html;
      container.classList.add('fade-in');
      
      if (q.type === 'matching') {
        setupMatchingDragDrop(qIndex);
      }
      
      const doubtBtnText = document.getElementById('doubtBtnText');
      doubtBtnText.textContent = doubts.has(qIndex) ? 'Hapus Ragu' : 'Ragu-ragu';
      
      document.getElementById('prevBtn').disabled = currentQuestion === 0;
    }
    
    function getQuestionTypeLabel(type) {
      const labels = {
        'single': 'Pilihan Ganda',
        'multiple': 'Pilihan Ganda Kompleks',
        'short': 'Isian Singkat',
        'matching': 'Menjodohkan',
        'truefalse': 'Benar/Salah',
        'agree-disagree': 'Setuju/Tidak Setuju'
      };
      return labels[type] || type;
    }
    
    function renderSingleChoice(q, saved) {
      let html = `<div class="space-y-3">`;
      
      // If question has images (like question 19 with diagrams)
      if (q.images && q.images.length > 0) {
        q.options.forEach((opt, i) => {
          const img = q.images[i];
          const label = String.fromCharCode(65 + i); // A, B, C, D
          html += `
            <label class="flex flex-col gap-3 p-4 border-2 rounded-xl cursor-pointer transition-all hover:border-blue-300 hover:bg-blue-50 ${saved === opt ? 'border-blue-500 bg-blue-50' : 'border-gray-200'}">
              <div class="flex items-start gap-4">
                <input type="radio" name="answer" value="${opt}" ${saved === opt ? 'checked' : ''} 
                  onchange="saveAnswer('${opt}')" 
                  class="w-5 h-5 text-blue-600 border-gray-300 focus:ring-blue-500 flex-shrink-0 mt-1">
                <span class="font-bold text-lg text-blue-600">${label}.</span>
              </div>
              <div class="bg-gray-50 rounded-lg p-3 overflow-hidden">
                <img src="${img.url}" alt="${img.label}" class="w-full h-auto max-h-screen object-contain rounded" loading="lazy"
                  onerror="console.error('Image failed to load:', this.src); this.style.background='#e5e7eb'; this.alt='Gambar tidak dapat dimuat';">
              </div>
            </label>
          `;
        });
      } else {
        // Regular text options
        html += q.options.map((opt, i) => `
          <label class="flex items-center gap-4 p-4 border-2 rounded-xl cursor-pointer transition-all hover:border-blue-300 hover:bg-blue-50 ${saved === opt ? 'border-blue-500 bg-blue-50' : 'border-gray-200'}">
            <input type="radio" name="answer" value="${opt}" ${saved === opt ? 'checked' : ''} 
              onchange="saveAnswer('${opt}')" 
              class="w-5 h-5 text-blue-600 border-gray-300 focus:ring-blue-500">
            <span class="flex-1 text-gray-700">${String.fromCharCode(65 + i)}. ${opt}</span>
          </label>
        `).join('');
      }
      
      html += `</div>`;
      return html;
    }
    
    function renderMultipleChoice(q, saved) {
      const savedArr = saved ? JSON.parse(saved) : [];
      return `
        <p class="text-sm text-gray-500 mb-4 bg-yellow-50 p-3 rounded-lg">💡 Pilih semua jawaban yang benar</p>
        <div class="space-y-3">
          ${q.options.map((opt, i) => `
            <label class="flex items-center gap-4 p-4 border-2 rounded-xl cursor-pointer transition-all hover:border-blue-300 hover:bg-blue-50 ${savedArr.includes(opt) ? 'border-blue-500 bg-blue-50' : 'border-gray-200'}">
              <input type="checkbox" value="${opt}" ${savedArr.includes(opt) ? 'checked' : ''} 
                onchange="saveMultipleAnswer()" 
                class="w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
              <span class="flex-1 text-gray-700">${String.fromCharCode(65 + i)}. ${opt}</span>
            </label>
          `).join('')}
        </div>
      `;
    }
    
    function renderShortAnswer(q, saved) {
      return `
        <div class="max-w-md">
          <input type="text" value="${saved || ''}" 
            oninput="saveAnswer(this.value)"
            placeholder="Ketik jawaban Anda..."
            class="w-full px-5 py-4 text-lg border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all outline-none">
          <p class="text-sm text-gray-500 mt-2">Ketik angka atau teks singkat sebagai jawaban</p>
        </div>
      `;
    }
    
    function renderMatching(q, saved) {
      const savedMatch = saved ? JSON.parse(saved) : {};
      const shuffledRight = shuffleArray([...q.rightItems]);
      
      return `
        <p class="text-sm text-gray-500 mb-4 bg-yellow-50 p-3 rounded-lg">💡 <span class="hidden md:inline">Seret item dari kanan ke kotak yang sesuai di kiri</span><span class="md:hidden">Ketuk item di kanan, lalu ketuk kotak tujuan di kiri</span></p>
        <div class="flex gap-8">
          <div class="flex-1 space-y-3">
            ${q.leftItems.map((left, i) => `
              <div class="flex items-center gap-3">
                <span class="w-8 h-8 bg-blue-100 text-blue-700 rounded-lg flex items-center justify-center font-bold text-sm">${i + 1}</span>
                <span class="flex-1 font-medium text-gray-700">${left}</span>
                <div class="drop-zone w-32 h-11 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center text-sm text-gray-400 ${savedMatch[left] ? 'matched-item border-solid' : ''}" 
                  data-left="${left}">
                  ${savedMatch[left] || 'Taruh di sini'}
                </div>
              </div>
            `).join('')}
          </div>
          <div class="w-40 space-y-2" id="dragContainer">
            ${shuffledRight.filter(r => !Object.values(savedMatch).includes(r)).map(right => `
              <div class="drag-item bg-gradient-to-r from-indigo-500 to-purple-500 text-white px-4 py-3 rounded-lg text-sm font-medium text-center shadow-md" draggable="true" data-value="${right}">
                ${right}
              </div>
            `).join('')}
          </div>
        </div>
      `;
    }
    
    function renderTrueFalse(q, saved) {
      const savedObj = saved ? JSON.parse(saved) : {};
      return `
        <div class="overflow-x-auto">
          <table class="w-full border-collapse">
            <thead>
              <tr class="bg-gray-100">
                <th class="border border-gray-200 px-4 py-3 text-left font-semibold text-gray-700">Pernyataan</th>
                <th class="border border-gray-200 px-4 py-3 w-24 text-center font-semibold text-gray-700">Benar</th>
                <th class="border border-gray-200 px-4 py-3 w-24 text-center font-semibold text-gray-700">Salah</th>
              </tr>
            </thead>
            <tbody>
              ${q.statements.map((stmt, i) => `
                <tr class="hover:bg-gray-50">
                  <td class="border border-gray-200 px-4 py-3 text-gray-700">${stmt.text}</td>
                  <td class="border border-gray-200 px-4 py-3 text-center">
                    <input type="radio" name="tf_${i}" value="true" ${savedObj[i] === true ? 'checked' : ''} 
                      onchange="saveTrueFalseAnswer(${i}, true)"
                      class="w-5 h-5 text-green-600 border-gray-300 focus:ring-green-500">
                  </td>
                  <td class="border border-gray-200 px-4 py-3 text-center">
                    <input type="radio" name="tf_${i}" value="false" ${savedObj[i] === false ? 'checked' : ''} 
                      onchange="saveTrueFalseAnswer(${i}, false)"
                      class="w-5 h-5 text-red-600 border-gray-300 focus:ring-red-500">
                  </td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>
      `;
    }
    
    function renderAgreeDisagree(q, saved) {
      const savedObj = saved ? JSON.parse(saved) : {};
      
      // Determine header text based on question content
      let header1 = 'Setuju';
      let header2 = 'Tidak Setuju';
      
      if (q.question && q.question.includes('Sesuai')) {
        header1 = 'Sesuai';
        header2 = 'Tidak Sesuai';
      }
      
      return `
        <div class="overflow-x-auto">
          <table class="w-full border-collapse">
            <thead>
              <tr class="bg-gray-100">
                <th class="border border-gray-200 px-4 py-3 text-left font-semibold text-gray-700">Pernyataan</th>
                <th class="border border-gray-200 px-4 py-3 w-32 text-center font-semibold text-gray-700">${header1}</th>
                <th class="border border-gray-200 px-4 py-3 w-32 text-center font-semibold text-gray-700">${header2}</th>
              </tr>
            </thead>
            <tbody>
              ${q.statements.map((stmt, i) => `
                <tr class="hover:bg-gray-50">
                  <td class="border border-gray-200 px-4 py-3 text-gray-700">${stmt.text}</td>
                  <td class="border border-gray-200 px-4 py-3 text-center">
                    <input type="radio" name="ad_${i}" value="true" ${savedObj[i] === true ? 'checked' : ''} 
                      onchange="saveAgreeDisagreeAnswer(${i}, true)"
                      class="w-5 h-5 text-green-600 border-gray-300 focus:ring-green-500">
                  </td>
                  <td class="border border-gray-200 px-4 py-3 text-center">
                    <input type="radio" name="ad_${i}" value="false" ${savedObj[i] === false ? 'checked' : ''} 
                      onchange="saveAgreeDisagreeAnswer(${i}, false)"
                      class="w-5 h-5 text-red-600 border-gray-300 focus:ring-red-500">
                  </td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>
      `;
    }
    
    function setupMatchingDragDrop(qIndex) {
      const dragItems = document.querySelectorAll('.drag-item');
      const dropZones = document.querySelectorAll('.drop-zone');
      
      let selectedDragItem = null;
      
      // Desktop drag & drop events
      dragItems.forEach(item => {
        item.addEventListener('dragstart', (e) => {
          e.dataTransfer.setData('text/plain', item.dataset.value);
          item.classList.add('dragging');
        });
        
        item.addEventListener('dragend', () => {
          item.classList.remove('dragging');
        });
        
        // Touch events untuk mobile (Android/iOS)
        item.addEventListener('touchstart', (e) => {
          e.preventDefault();
          selectedDragItem = item;
          item.style.opacity = '0.5';
          item.style.transform = 'scale(1.05)';
        });
        
        item.addEventListener('touchend', (e) => {
          e.preventDefault();
          item.style.opacity = '1';
          item.style.transform = 'scale(1)';
          
          if (selectedDragItem) {
            const touch = e.changedTouches[0];
            const targetElement = document.elementFromPoint(touch.clientX, touch.clientY);
            const dropZone = targetElement?.closest('.drop-zone');
            
            if (dropZone) {
              handleDrop(dropZone, selectedDragItem.dataset.value);
            }
            selectedDragItem = null;
          }
        });
        
        // Click events untuk alternatif
        item.addEventListener('click', (e) => {
          e.preventDefault();
          if (selectedDragItem && selectedDragItem !== item) {
            selectedDragItem.classList.remove('selected-drag-item');
          }
          selectedDragItem = item;
          item.classList.add('selected-drag-item');
          
          // Visual feedback
          dragItems.forEach(di => {
            if (di !== item) di.classList.remove('selected-drag-item');
          });
        });
      });
      
      function handleDrop(zone, value) {
        // Return old item to drag container if zone is already matched
        if (zone.classList.contains('matched-item')) {
          const oldValue = zone.textContent;
          const dragContainer = document.getElementById('dragContainer');
          const newDragItem = document.createElement('div');
          newDragItem.className = 'drag-item bg-gradient-to-r from-indigo-500 to-purple-500 text-white px-4 py-3 rounded-lg text-sm font-medium text-center shadow-md';
          newDragItem.draggable = true;
          newDragItem.dataset.value = oldValue;
          newDragItem.textContent = oldValue;
          dragContainer.appendChild(newDragItem);
        }
        
        // Place new item in zone
        zone.textContent = value;
        zone.classList.add('matched-item', 'border-solid');
        zone.classList.remove('border-dashed');
        
        // Remove dragged item
        const draggedItem = document.querySelector(`.drag-item[data-value="${value}"]`);
        if (draggedItem) draggedItem.remove();
        
        // Re-setup events
        setupMatchingDragDrop(qIndex);
        saveMatchingAnswer();
      }
      
      dropZones.forEach(zone => {
        // Desktop drag events
        zone.addEventListener('dragover', (e) => {
          e.preventDefault();
          zone.classList.add('drag-over');
        });
        
        zone.addEventListener('dragleave', () => {
          zone.classList.remove('drag-over');
        });
        
        zone.addEventListener('drop', (e) => {
          e.preventDefault();
          zone.classList.remove('drag-over');
          const value = e.dataTransfer.getData('text/plain');
          handleDrop(zone, value);
        });
        
        // Touch events untuk mobile
        zone.addEventListener('touchend', (e) => {
          e.preventDefault();
          if (selectedDragItem) {
            handleDrop(zone, selectedDragItem.dataset.value);
            selectedDragItem = null;
          }
        });
        
        // Click untuk memilih zona tujuan
        zone.addEventListener('click', (e) => {
          e.preventDefault();
          
          // If zone is matched, return item to container
          if (zone.classList.contains('matched-item')) {
            const value = zone.textContent;
            const dragContainer = document.getElementById('dragContainer');
            const newDragItem = document.createElement('div');
            newDragItem.className = 'drag-item bg-gradient-to-r from-indigo-500 to-purple-500 text-white px-4 py-3 rounded-lg text-sm font-medium text-center shadow-md';
            newDragItem.draggable = true;
            newDragItem.dataset.value = value;
            newDragItem.textContent = value;
            dragContainer.appendChild(newDragItem);
            
            zone.textContent = 'Taruh di sini';
            zone.classList.remove('matched-item', 'border-solid');
            zone.classList.add('border-dashed');
            
            setupMatchingDragDrop(qIndex);
            saveMatchingAnswer();
          } 
          // If there's a selected item, place it in this zone
          else if (selectedDragItem) {
            handleDrop(zone, selectedDragItem.dataset.value);
            selectedDragItem = null;
            
            // Remove selection highlight from all items
            dragItems.forEach(di => di.classList.remove('selected-drag-item'));
          }
        });
      });
    }
    
    // =============================================
    // ANSWER SAVING FUNCTIONS
    // =============================================
    
    function saveAnswer(value) {
      const qIndex = questionOrder[currentQuestion];
      answers[qIndex] = value;
      updateProgress();
      renderQuestionNav();
    }
    
    function saveMultipleAnswer() {
      const qIndex = questionOrder[currentQuestion];
      // Hanya ambil checkbox yang benar-benar ada di label dengan class "flex items-center gap-4"
      const checkboxes = document.querySelectorAll('label.flex.items-center.gap-4 input[type="checkbox"]:checked');
      const values = Array.from(checkboxes)
        .map(cb => cb.value)
        .filter(v => v && v !== 'on'); // Filter out empty values and "on"
      answers[qIndex] = JSON.stringify(values);
      updateProgress();
      renderQuestionNav();
    }
    
    function saveMatchingAnswer() {
      const qIndex = questionOrder[currentQuestion];
      const dropZones = document.querySelectorAll('.drop-zone.matched-item');
      const match = {};
      dropZones.forEach(zone => {
        match[zone.dataset.left] = zone.textContent;
      });
      answers[qIndex] = JSON.stringify(match);
      updateProgress();
      renderQuestionNav();
    }
    
    function saveTrueFalseAnswer(index, value) {
      const qIndex = questionOrder[currentQuestion];
      let savedObj = answers[qIndex] ? JSON.parse(answers[qIndex]) : {};
      savedObj[index] = value;
      answers[qIndex] = JSON.stringify(savedObj);
      updateProgress();
      renderQuestionNav();
    }
    
    function saveAgreeDisagreeAnswer(index, value) {
      const qIndex = questionOrder[currentQuestion];
      let savedObj = answers[qIndex] ? JSON.parse(answers[qIndex]) : {};
      savedObj[index] = value;
      answers[qIndex] = JSON.stringify(savedObj);
      updateProgress();
      renderQuestionNav();
    }
    
    // =============================================
    // NAVIGATION AND PROGRESS
    // =============================================
    
    function renderQuestionNav() {
      const navHTML = questionOrder.map((qIndex, i) => {
        const hasAnswer = answers[qIndex] !== undefined && answers[qIndex] !== '' && answers[qIndex] !== '{}' && answers[qIndex] !== '[]';
        const isDoubt = doubts.has(qIndex);
        const isCurrent = i === currentQuestion;
        
        let bgClass = 'bg-gray-200 text-gray-600';
        if (hasAnswer) bgClass = 'bg-green-500 text-white';
        if (isDoubt) bgClass = 'bg-yellow-400 text-white';
        if (isCurrent) bgClass += ' ring-2 ring-blue-600 ring-offset-2';
        
        return `
          <button onclick="goToQuestion(${i})" 
            class="question-num w-10 h-10 rounded-lg font-semibold text-sm ${bgClass} hover:opacity-80">
            ${i + 1}
          </button>
        `;
      }).join('');
      
      // Update both desktop and mobile navigation
      document.getElementById('questionNav').innerHTML = navHTML;
    }
    
    function goToQuestion(index) {
      currentQuestion = index;
      renderQuestion();
      renderQuestionNav();
    }
    
    function prevQuestion() {
      if (currentQuestion > 0) {
        currentQuestion--;
        renderQuestion();
        renderQuestionNav();
      }
    }
    
    function nextQuestion() {
      if (currentQuestion < questions.length - 1) {
        currentQuestion++;
        renderQuestion();
        renderQuestionNav();
      }
    }
    
    function toggleDoubt() {
      const qIndex = questionOrder[currentQuestion];
      if (doubts.has(qIndex)) {
        doubts.delete(qIndex);
      } else {
        doubts.add(qIndex);
      }
      renderQuestion();
      renderQuestionNav();
    }
    
    function updateProgress() {
      const answered = Object.keys(answers).filter(k => {
        const val = answers[k];
        return val !== undefined && val !== '' && val !== '{}' && val !== '[]';
      }).length;
      
      const percentage = questions.length > 0 ? (answered / questions.length) * 100 : 0;
      document.getElementById('progressBar').style.width = `${percentage}%`;
      document.getElementById('progressText').textContent = `${answered}/${questions.length} soal dijawab`;
    }
    
    // =============================================
    // EXAM SUBMISSION
    // =============================================
    
    function showSubmitConfirmation() {
      const answered = Object.keys(answers).filter(k => {
        const val = answers[k];
        return val !== undefined && val !== '' && val !== '{}' && val !== '[]';
      }).length;
      
      document.getElementById('confirmSubmitText').textContent = 
        `Anda telah menjawab ${answered} dari ${questions.length} soal. Yakin ingin mengumpulkan?`;
      
      document.getElementById('confirmSubmitModal').classList.remove('hidden');
      document.getElementById('confirmSubmitModal').classList.add('flex');
    }
    
    function hideSubmitConfirmation() {
      document.getElementById('confirmSubmitModal').classList.add('hidden');
      document.getElementById('confirmSubmitModal').classList.remove('flex');
    }
    
    async function submitExam() {
      if (timerInterval) clearInterval(timerInterval);
      hideSubmitConfirmation();
      
      let correct = 0;
      questions.forEach((q, i) => {
        const userAnswer = answers[i];
        if (checkAnswer(q, userAnswer)) {
          correct++;
        }
      });
      
      const score = questions.length > 0 ? Math.round((correct / questions.length) * 100) : 0;
      const now = new Date();
      
      const result = {
        username: currentUser.username,
        name: currentUser.name,
        kelas: currentUser.kelas,
        answers: JSON.stringify(answers),
        doubts: JSON.stringify([...doubts]),
        score: score,
        total_correct: correct,
        time_remaining: timeRemaining
      };
      
      const success = await saveResultToSheet(result);
      
      if (success) {
        document.getElementById('finalScore').textContent = score;
        document.getElementById('scoreDetail').textContent = `${correct} dari ${questions.length} soal benar`;
        document.getElementById('resultName').textContent = currentUser.name;
        document.getElementById('resultClass').textContent = currentUser.kelas;
        document.getElementById('resultTime').textContent = now.toLocaleString('id-ID');
        
        showPage('resultPage');
        showToast('Jawaban berhasil dikumpulkan!');
      }
    }
    
    function checkAnswer(q, userAnswer) {
      if (userAnswer === undefined || userAnswer === null || userAnswer === '') {
        console.log(`Q${q.id}: Kosong, return false`);
        return false;
      }
      
      switch(q.type) {
        case 'single':
          const userSingle = String(userAnswer).trim();
          const correctSingle = String(q.answer).trim();
          const isMatch = userSingle === correctSingle;
          console.log(`✓ Q${q.id} Single: User="${userSingle}" vs Correct="${correctSingle}" = ${isMatch}`);
          return isMatch;
          
        case 'short':
          const userShort = String(userAnswer).trim().toLowerCase();
          const correctShort = String(q.answer).trim().toLowerCase();
          const isShortMatch = userShort === correctShort;
          console.log(`������� Q${q.id} Short: User="${userShort}" vs Correct="${correctShort}" = ${isShortMatch}`);
          return isShortMatch;
          
        case 'multiple':
          console.log(`========== CEK Q${q.id} MULTIPLE ==========`);
          console.log('Raw userAnswer:', userAnswer);
          console.log('Raw q.answer:', q.answer);
          
          try {
            let userArr = [];
            let correctArr = [];
            
            // Parse user answer
            if (typeof userAnswer === 'string') {
              try {
                userArr = JSON.parse(userAnswer);
                console.log('Parsed userAnswer dari JSON:', userArr);
              } catch (e) {
                userArr = [userAnswer];
                console.log('userAnswer bukan JSON, gunakan sebagai array:', userArr);
              }
            } else {
              userArr = Array.isArray(userAnswer) ? userAnswer : [userAnswer];
              console.log('userAnswer adalah:', userArr);
            }
            
            // Parse correct answer
            if (Array.isArray(q.answer)) {
              correctArr = q.answer;
              console.log('q.answer adalah array:', correctArr);
            } else if (typeof q.answer === 'string') {
              try {
                correctArr = JSON.parse(q.answer);
                console.log('Parsed q.answer dari JSON:', correctArr);
              } catch (e) {
                correctArr = [q.answer];
                console.log('q.answer bukan JSON, gunakan sebagai array:', correctArr);
              }
            } else {
              correctArr = [q.answer];
              console.log('q.answer converted to array:', correctArr);
            }
            
            console.log('Sebelum normalize - User:', userArr);
            console.log('Sebelum normalize - Correct:', correctArr);
            
            // Normalize strings (trim dan lowercase)
            userArr = userArr.map(a => String(a).trim());
            correctArr = correctArr.map(a => String(a).trim());
            
            console.log('Setelah trim - User:', userArr);
            console.log('Setelah trim - Correct:', correctArr);
            
            // Sort both arrays for comparison
            const sortedUser = userArr.sort();
            const sortedCorrect = correctArr.sort();
            
            console.log('Sorted User:', sortedUser);
            console.log('Sorted Correct:', sortedCorrect);
            
            const jsonUser = JSON.stringify(sortedUser);
            const jsonCorrect = JSON.stringify(sortedCorrect);
            
            console.log('JSON User:', jsonUser);
            console.log('JSON Correct:', jsonCorrect);
            
            const isMultiMatch = jsonUser === jsonCorrect;
            console.log(`✓ Q${q.id} Multiple Result: ${isMultiMatch ? '�� BENAR' : '❌ SALAH'}`);
            console.log('==========================================\n');
            
            return isMultiMatch;
          } catch (e) { 
            console.error(`Q${q.id} Error checking multiple answer:`, e);
            console.log('userAnswer:', userAnswer);
            console.log('q.answer:', q.answer);
            console.log('==========================================\n');
            return false; 
          }
          
        case 'matching':
          try {
            const userMatch = typeof userAnswer === 'string' ? JSON.parse(userAnswer) : userAnswer;
            const correctMatch = typeof q.answer === 'string' ? JSON.parse(q.answer) : q.answer;
            const isMatchingMatch = JSON.stringify(userMatch) === JSON.stringify(correctMatch);
            console.log(`✓ Q${q.id} Matching: Match = ${isMatchingMatch}`);
            return isMatchingMatch;
          } catch (e) { 
            console.error(`Q${q.id} Error checking matching:`, e);
            return false; 
          }
          
        case 'truefalse':
          try {
            const userObj = typeof userAnswer === 'string' ? JSON.parse(userAnswer) : userAnswer;
            const isTFMatch = q.statements.every((stmt, i) => userObj[i] === stmt.answer);
            console.log(`✓ Q${q.id} TrueFalse: Match = ${isTFMatch}`);
            return isTFMatch;
          } catch (e) {
            console.error(`Q${q.id} Error checking truefalse:`, e);
            return false;
          }
          
        case 'agree-disagree':
          try {
            const userObj = typeof userAnswer === 'string' ? JSON.parse(userAnswer) : userAnswer;
            const isADMatch = q.statements.every((stmt, i) => userObj[i] === stmt.answer);
            console.log(`✓ Q${q.id} AgreeDisagree: Match = ${isADMatch}`);
            return isADMatch;
          } catch (e) {
            console.error(`Q${q.id} Error checking agree-disagree:`, e);
            return false;
          }
          
        default:
          console.log(`Q${q.id}: Tipe ${q.type} tidak dikenal`);
          return false;
      }
    }
    
    function logout() {
      if (timerInterval) clearInterval(timerInterval);
      currentUser = null;
      answers = {};
      doubts = new Set();
      document.getElementById('username').value = '';
      document.getElementById('password').value = '';
      showPage('loginPage');
    }
    
    // =============================================
    // ADMIN FUNCTIONS
    // =============================================
    
    function renderAdminData() {
      renderUsersTable();
      renderResultsTable();
      document.getElementById('settingQuestions').value = questions.length;
    }
    
    function renderUsersTable() {
      const users = getUsers();
      const tbody = document.getElementById('usersTableBody');
      const noMessage = document.getElementById('noUsersMessage');
      
      if (users.length === 0) {
        tbody.innerHTML = '';
        noMessage.classList.remove('hidden');
        return;
      }
      
      noMessage.classList.add('hidden');
      tbody.innerHTML = users.map(user => `
        <tr class="hover:bg-gray-50">
          <td class="px-4 md:px-6 py-4">
            <img src="${user.photo || ''}" alt="" class="w-10 h-10 rounded-full object-cover bg-gray-200" loading="lazy"
              onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22%23999%22><circle cx=%2212%22 cy=%228%22 r=%224%22/><path d=%22M12 14c-4 0-7 2-7 5v1h14v-1c0-3-3-5-7-5z%22/></svg>'">
          </td>
          <td class="px-4 md:px-6 py-4 font-medium text-gray-800 text-sm">${user.username}</td>
          <td class="px-4 md:px-6 py-4 text-gray-600 text-sm">${user.name}</td>
          <td class="px-4 md:px-6 py-4 text-gray-600 text-sm">${user.kelas}</td>
          <td class="px-4 md:px-6 py-4">
            <span class="px-2 py-1 rounded-lg text-xs font-medium ${user.role === 'admin' ? 'bg-purple-100 text-purple-700' : 'bg-blue-100 text-blue-700'}">
              ${user.role || 'siswa'}
            </span>
          </td>
          <td class="px-4 md:px-6 py-4">
            <div class="flex gap-2">
              <button onclick="editUser('${user.__backendId}')" class="text-blue-600 hover:text-blue-800 text-xs md:text-sm font-medium">Edit</button>
              <button onclick="confirmDeleteUser('${user.__backendId}')" class="text-red-600 hover:text-red-800 text-xs md:text-sm font-medium">Hapus</button>
            </div>
          </td>
        </tr>
      `).join('');
    }
    
    function renderResultsTable() {
      const results = getResults();
      const users = getUsers();
      const tbody = document.getElementById('resultsTableBody');
      const noMessage = document.getElementById('noResultsMessage');
      
      document.getElementById('totalParticipants').textContent = users.length;
      document.getElementById('completedCount').textContent = results.length;
      
      if (results.length > 0) {
        const scores = results.map(r => r.score);
        const avgScore = Math.round(scores.reduce((a, b) => a + b, 0) / scores.length);
        const maxScore = Math.max(...scores);
        document.getElementById('averageScore').textContent = avgScore;
        document.getElementById('highestScore').textContent = maxScore;
      } else {
        document.getElementById('averageScore').textContent = '0';
        document.getElementById('highestScore').textContent = '0';
      }
      
      if (results.length === 0) {
        tbody.innerHTML = '';
        noMessage.classList.remove('hidden');
        return;
      }
      
      noMessage.classList.add('hidden');
      tbody.innerHTML = results.map((result, i) => `
        <tr class="hover:bg-gray-50">
          <td class="px-4 md:px-6 py-4 text-gray-600 text-sm">${i + 1}</td>
          <td class="px-4 md:px-6 py-4 font-medium text-gray-800 text-sm">${result.name}</td>
          <td class="px-4 md:px-6 py-4 text-gray-600 text-sm">${result.kelas}</td>
          <td class="px-4 md:px-6 py-4">
            <span class="px-3 py-1 rounded-full text-xs md:text-sm font-bold ${result.score >= 70 ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}">
              ${result.score}
            </span>
          </td>
          <td class="px-4 md:px-6 py-4 text-gray-600 text-sm">${result.total_correct}/${questions.length}</td>
          <td class="px-4 md:px-6 py-4 text-gray-600 text-xs md:text-sm">${new Date(result.timestamp || result.submitted_at).toLocaleString('id-ID')}</td>
        </tr>
      `).join('');
    }
    
    function showUserModal(user = null) {
      const modal = document.getElementById('userModal');
      const title = document.getElementById('userModalTitle');
      
      if (user) {
        title.textContent = 'Edit Pengguna';
        document.getElementById('editUserId').value = user.username;
        document.getElementById('userUsername').value = user.username;
        document.getElementById('userPassword').value = user.password;
        document.getElementById('userFullname').value = user.name;
        document.getElementById('userKelas').value = user.kelas;
        document.getElementById('userPhoto').value = user.photo || '';
      } else {
        title.textContent = 'Tambah Pengguna';
        document.getElementById('editUserId').value = '';
        document.getElementById('userForm').reset();
      }
      
      modal.classList.remove('hidden');
      modal.classList.add('flex');
    }
    
    function hideUserModal() {
      document.getElementById('userModal').classList.add('hidden');
      document.getElementById('userModal').classList.remove('flex');
    }
    
    async function saveUser(e) {
      e.preventDefault();
      
      const editId = document.getElementById('editUserId').value;
      const userData = {
        username: document.getElementById('userUsername').value.trim(),
        password: document.getElementById('userPassword').value.trim(),
        name: document.getElementById('userFullname').value.trim(),
        kelas: document.getElementById('userKelas').value.trim(),
        photo: document.getElementById('userPhoto').value.trim(),
        role: 'siswa'
      };
      
      let success = false;
      if (editId) {
        userData.oldUsername = editId;
        success = await updateUserInSheet(userData);
      } else {
        success = await addUserToSheet(userData);
      }
      
      if (success) {
        hideUserModal();
        renderAdminData();
        showToast(editId ? 'Pengguna berhasil diperbarui!' : 'Pengguna berhasil ditambahkan!');
      }
    }
    
    function editUser(id) {
      const user = allData.find(d => d.__backendId === id);
      if (user) {
        showUserModal(user);
      }
    }
    
    function confirmDeleteUser(id) {
      deleteTargetId = id;
      document.getElementById('deleteConfirmModal').classList.remove('hidden');
      document.getElementById('deleteConfirmModal').classList.add('flex');
    }
    
    function hideDeleteConfirm() {
      document.getElementById('deleteConfirmModal').classList.add('hidden');
      document.getElementById('deleteConfirmModal').classList.remove('flex');
      deleteTargetId = null;
    }
    
    async function deleteUser() {
      if (!deleteTargetId) return;
      
      const user = allData.find(d => d.__backendId === deleteTargetId);
      if (user) {
        const success = await deleteUserFromSheet(user.username);
        if (success) {
          renderAdminData();
          showToast('Pengguna berhasil dihapus!');
        }
      }
      
      hideDeleteConfirm();
    }
    
    function switchAdminTab(tabName) {
      document.querySelectorAll('.admin-tab').forEach(tab => tab.classList.add('hidden'));
      document.querySelectorAll('.admin-nav-btn').forEach(btn => btn.classList.remove('active', 'bg-gray-700'));
      
      document.getElementById(`${tabName}Tab`).classList.remove('hidden');
      document.querySelector(`[data-tab="${tabName}"]`).classList.add('active', 'bg-gray-700');
    }
    
    async function refreshAdminData() {
      showLoading('Memuat ulang data...');
      await fetchAllData();
      renderAdminData();
      hideLoading();
      showToast('Data berhasil diperbarui!');
    }
    
    // =============================================
    // INITIALIZATION
    // =============================================
    
    async function init() {
      // Initialize Element SDK
      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange: async (newConfig) => {
            config = { ...defaultConfig, ...newConfig };
            
            const headerTitle = document.getElementById('headerTitle');
            const examTitle = document.getElementById('examTitle');
            
            if (headerTitle) headerTitle.textContent = config.app_title || defaultConfig.app_title;
            if (examTitle) examTitle.textContent = config.app_title || defaultConfig.app_title;
          },
          mapToCapabilities: (cfg) => ({
            recolorables: [],
            borderables: [],
            fontEditable: undefined,
            fontSizeable: undefined
          }),
          mapToEditPanelValues: (cfg) => new Map([
            ['app_title', cfg.app_title || defaultConfig.app_title],
            ['exam_duration', cfg.exam_duration || defaultConfig.exam_duration]
          ])
        });
      }
      
      // Fetch initial data from Google Sheets
      showLoading('Memuat data dari spreadsheet...');
      await fetchAllData();
      hideLoading();
      
      // Event Listeners
      document.getElementById('loginForm').addEventListener('submit', handleStudentLogin);
      document.getElementById('adminLoginForm').addEventListener('submit', handleAdminLogin);
      document.getElementById('adminLoginBtn').addEventListener('click', () => showPage('adminLoginPage'));
      document.getElementById('backToStudentLogin').addEventListener('click', () => showPage('loginPage'));
      document.getElementById('logoutBtn').addEventListener('click', logout);
      document.getElementById('adminLogoutBtn').addEventListener('click', () => showPage('loginPage'));
      document.getElementById('backToLoginBtn').addEventListener('click', () => {
        logout();
        showPage('loginPage');
      });
      
      document.getElementById('prevBtn').addEventListener('click', prevQuestion);
      document.getElementById('nextBtn').addEventListener('click', nextQuestion);
      document.getElementById('doubtBtn').addEventListener('click', toggleDoubt);
      document.getElementById('submitExamBtn').addEventListener('click', showSubmitConfirmation);
      
      document.getElementById('cancelSubmitBtn').addEventListener('click', hideSubmitConfirmation);
      document.getElementById('confirmSubmitBtn').addEventListener('click', submitExam);
      
      document.querySelectorAll('.admin-nav-btn').forEach(btn => {
        btn.addEventListener('click', () => switchAdminTab(btn.dataset.tab));
      });
      
      document.getElementById('addUserBtn').addEventListener('click', () => showUserModal());
      document.getElementById('cancelUserBtn').addEventListener('click', hideUserModal);
      document.getElementById('userForm').addEventListener('submit', saveUser);
      document.getElementById('refreshDataBtn').addEventListener('click', refreshAdminData);
      
      document.getElementById('cancelDeleteBtn').addEventListener('click', hideDeleteConfirm);
      document.getElementById('confirmDeleteBtn').addEventListener('click', deleteUser);
      
      document.getElementById('settingsForm').addEventListener('submit', (e) => {
        e.preventDefault();
        config.app_title = document.getElementById('settingTitle').value;
        config.exam_duration = document.getElementById('settingDuration').value;
        
        if (window.elementSdk) {
          window.elementSdk.setConfig({
            app_title: config.app_title,
            exam_duration: config.exam_duration
          });
        }
        
        showToast('Pengaturan berhasil disimpan!');
      });
      
      document.getElementById('exportResultsBtn').addEventListener('click', () => {
        const results = getResults();
        if (results.length === 0) {
          showToast('Tidak ada data untuk diexport', false);
          return;
        }
        
        let csv = 'No,Nama,Kelas,Skor,Benar,Waktu Selesai\n';
        results.forEach((r, i) => {
          csv += `${i+1},"${r.name}","${r.kelas}",${r.score},${r.total_correct},"${new Date(r.timestamp || r.submitted_at).toLocaleString('id-ID')}"\n`;
        });
        
        const blob = new Blob([csv], { type: 'text/csv' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'hasil_ujian.csv';
        a.click();
        URL.revokeObjectURL(url);
        
        showToast('Data berhasil diexport!');
      });
    }
    
    init();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c6b3cc7c53503d4',t:'MTc2OTg4Mzc3Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>